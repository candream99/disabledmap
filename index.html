<!DOCTYPE html>
<html lang="ko">
<head>
    <script type="text/javascript">
    // ì ‘ì†í•œ ê¸°ê¸°ê°€ ëª¨ë°”ì¼ì¸ì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
    function isMobile() {
        return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    }

    // ë°ìŠ¤í¬í†±(PC)ì¼ ê²½ìš°, ë‚´ë¶€ì— ë§Œë“  'pc' í´ë”ì˜ index.htmlë¡œ ì´ë™
    if (!isMobile()) {
        // ë„ë©”ì¸ì„ ìœ ì§€í•˜ë©´ì„œ í´ë”ë§Œ ì´ë™í•©ë‹ˆë‹¤.
        window.location.href = "./pc/index.html"; 
    }
   </script> <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ë„¤ì´ë²„ ë²¡í„°ë§µ í…ŒìŠ¤íŠ¸ - ë¬´ì¥ì•  ì‹œì„¤ íŒì—… ìµœì¢…ë³¸ (ì¸µë³„ ê²½ê³„ ë¶„ë¦¬)</title>
    <style>
        /* ------------------------------------------------ */
        /* ëª¨ë°”ì¼ ìŠ¤í¬ë¡¤ ì ê¸ˆ */
        /* ------------------------------------------------ */
        body { 
            margin: 0;
            padding: 0; 
            height: 100vh; 
            font-family: 'Malgun Gothic', sans-serif;
            overflow: hidden; 
        }
        #map { width: 100%;
            height: 100%; 
        }
        
        /* ------------------------------------------------ */
        /* ê²€ìƒ‰ì°½ ìŠ¤íƒ€ì¼ */
        /* ------------------------------------------------ */
        #searchBox {
            position: absolute;
            top: 20px; 
            left: 50%;
            transform: translateX(-50%);
            width: 80vw; 
            max-width: 500px; 
            height: 48px;
            background: #ffffff;
            border-radius: 24px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.2); 
            display: flex;
            align-items: center;
            padding: 0 15px; 
            z-index: 2000;
        }
        #hamburgerBtn {
            width: 24px;
            height: 24px;
            background: none;
            border: none;
            padding: 0;
            margin-right: 10px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            align-items: center;
        }
        .burger-line {
            display: block;
            width: 18px;
            height: 2px;
            background-color: #333;
            border-radius: 1px;
        }
        /* ì´ˆê¸° í”Œë ˆì´ìŠ¤í™€ë” ìŠ¤íƒ€ì¼ */
        #searchPlaceholder {
            flex-grow: 1;
            font-size: 16px;
            color: #a0a0a0; 
            pointer-events: auto; 
            user-select: none;
        }
        
        /* ê²€ìƒ‰ ì…ë ¥ í•„ë“œ ìŠ¤íƒ€ì¼ */
        #searchInput {
            flex-grow: 1; 
            font-size: 16px;
            border: none;
            outline: none; 
            padding: 0;
            margin: 0;
            color: #333;
            background: transparent;
            width: calc(100% - 70px); 
            display: none; 
        }
        
        /* ê²€ìƒ‰ ë²„íŠ¼ ë° ë‹«ê¸° ë²„íŠ¼ ê³µí†µ ìŠ¤íƒ€ì¼ */
        .search-icon-btn {
            width: 24px;
            height: 24px;
            background: none;
            border: none;
            padding: 0;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
            font-size: 18px;
        }

        #searchBtn {
            margin-left: 5px; 
            display: none; 
        }

        #closeSearchBtn {
            margin-left: 5px; 
            display: none; 
        }
        
        /* ------------------------------------------------ */
        /* coordDisplay ìŠ¤íƒ€ì¼ */
        /* ------------------------------------------------ */
        #coordDisplay {
            position: absolute;
            top: 79px;
            left: 50%;
            transform: translateX(-50%);
            width: 80vw;
            max-width: 500px;
            height: 24px;
            background: rgba(255, 255, 255, 0.9);
            color: #000000;
            border-radius: 24px;
            display: flex;
            justify-content: center; 
            align-items: center; 
            padding: 0 15px; 
            font-size: 14px;
            z-index: 1500;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2); 
            transition: all 0.3s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            min-width: unset; 
        }

        /* ------------------------------------------------ */
        /* ê²€ìƒ‰ ëª©ë¡ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        /* ------------------------------------------------ */
        #searchListContainer {
            position: absolute;
            top: 108px; /* coordDisplay ì•„ë˜ì— ë“œë¡­ë‹¤ìš´ */
            left: 50%;
            transform: translateX(-50%);
            width: 80vw;
            max-width: 500px;
            background: white;
            border-radius: 6px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.3);
            z-index: 1500;
            padding: 0 10px; /* ë‚´ë¶€ padding ì¡°ì • */
            display: none; 
            max-height: 55vh; /* ìµœëŒ€ ë†’ì´ ì§€ì • */
            overflow-y: auto; /* ìŠ¤í¬ë¡¤ ê°€ëŠ¥ */
            overscroll-behavior: contain;
        }

        /* ë‹¨ì¼ ê²€ìƒ‰ ê²°ê³¼ í•­ëª© ìŠ¤íƒ€ì¼ */
        .search-result-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 0;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            transition: background-color 0.2s;
        }

        .search-result-item:hover {
            background-color: #f9f9f9;
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        /* ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
        .result-image {
            width: 60px; 
            height: 60px;
            object-fit: cover;
            border-radius: 4px;
            flex-shrink: 0;
        }

        /* í…ìŠ¤íŠ¸ ì •ë³´ ìŠ¤íƒ€ì¼ */
        .result-text-info {
            flex-grow: 1;
        }

        .result-name {
            font-weight: bold;
            font-size: 0.95rem;
            margin-bottom: 2px;
            color: #333;
        }

        /* ì£¼ì†Œ/ì˜ì—…ì‹œê°„ í•­ëª© ìŠ¤íƒ€ì¼ */
        .result-info-item {
            display: flex;
            align-items: flex-start;
            font-size: 0.75rem;
            color: #777;
            line-height: 1.3;
        }
        .result-info-item i {
            width: 12px;
            text-align: center;
            margin-right: 4px;
            line-height: 1.3;
        }
        
        /* ------------------------------------------------ */
        /* ê³µí†µ ì›í˜• ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .map-btn-circle {
            width: 40px;
            height: 40px;
            padding: 0;
            cursor: pointer;
            background: #ffffff;
            border: none; 
            border-radius: 50%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            color: #000;
            font-weight: normal;
            font-size: 14px;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            line-height: 1;
        }

        /* í˜„ì¬ ìœ„ì¹˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        #geolocationBtn {
            position: absolute;
            bottom: 18px; 
            left: 10px;
            z-index: 1500;
            font-size: 0; 
        }

        /* ----- Geolocation ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ ----- */
        #geolocationBtn .geo-icon {
            display: block;
            width: 18px;
            height: 18px;
            border: 2px solid #333; 
            border-radius: 50%;
            position: relative;
            box-sizing: border-box;
            background-color: transparent;
        }

        #geolocationBtn .geo-icon::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 4px;
            height: 4px;
            background-color: #333; 
            border-radius: 50%;
        }

        #geolocationBtn.active .geo-icon {
            border: none;
            background-color: transparent;
            width: 0;
            height: 0;
            transform: none; 
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-bottom: 12px solid #007bff;
            margin-bottom: 6px; 
        }

        #geolocationBtn.active .geo-icon::after {
            content: none;
        }
        /* ------------------------------------- */
        
        /* ì¸µ ì»¨íŠ¸ë¡¤ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ */
        #floorControls {
            position: absolute;
            bottom: 88px; 
            left: 10px;
            display: none;
            flex-direction: column-reverse; 
            gap: 8px; 
            z-index: 1500;
            background: transparent;
            padding: 0;
            box-shadow: none;
        }

        /* ì¸µ ë²„íŠ¼/ì•¡ì„¸ìŠ¤ ë²„íŠ¼ ìŠ¤íƒ€ì¼ (ê³µí†µ ì›í˜• ìŠ¤íƒ€ì¼ ìƒì†) */
        .floor-btn {
            font-size: 14px;
        }

        /* í´ë¦­ëœ ë²„íŠ¼ í™œì„± ìŠ¤íƒ€ì¼ */
        .map-btn-circle.active {
            background: #007bff;
            color: #fff;
            font-weight: bold;
        }

        /* ------------------------------------- */
        /* ë¬´ì¥ì•  ì‹œì„¤ ë²„íŠ¼ ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
        /* ------------------------------------- */
        #accessInfoBtn {
            margin-bottom: 18px;
            font-size: 0;
            line-height: 0; 
        }
        
        /* Icon (span inside button) */
        #accessInfoBtn .i-icon {
            display: block;
            width: 25px; 
            height: 25px;
            background-size: contain; 
            background-repeat: no-repeat;
            background-position: center;
            background-image: url('https://raw.githubusercontent.com/candream99/disabledmap/main/i_button.png');
        }

        /* í™œì„±í™” ì‹œ ì´ë¯¸ì§€ (íŒŒë€ìƒ‰ ë°°ê²½) */
        #accessInfoBtn.active .i-icon {
            background-image: url('https://raw.githubusercontent.com/candream99/disabledmap/main/i_button2.png');
        }
        /* ------------------------------------- */
        
        /* ë¬´ì¥ì•  íŒì—… (ìˆ˜ì •: max-heightì™€ overflow-y ì¶”ê°€) */
        #accessPopup {
            position: absolute;
            left: auto; /* JSì—ì„œ ìœ„ì¹˜ ê³„ì‚° */
            width: 90%;
            max-width: 240px;
            background: white;
            padding: 10px;
            border-radius: 6px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.3);
            display: none;
            z-index: 2000;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        /* --- íŒì—… ì„¹ì…˜ ìŠ¤íƒ€ì¼ --- */
        .popup-section {
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eee; /* ì„¹ì…˜ êµ¬ë¶„ì„  */
        }

        .popup-section:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        /* 1. ê±´ë¬¼ ì •ë³´ ì„¹ì…˜ ë ˆì´ì•„ì›ƒ */
        #buildingInfoSection {
            display: flex;
            align-items: flex-start;
            gap: 10px; /* ì‚¬ì§„ê³¼ í…ìŠ¤íŠ¸ ì‚¬ì´ ê°„ê²© */
        }

        /* ê±´ë¬¼ ì‚¬ì§„ */
        #buildingImage {
            width: 33.33%;
            height: auto;
            object-fit: cover;
            border-radius: 4px;
        }

        /* ê±´ë¬¼ ì •ë³´ í…ìŠ¤íŠ¸ ì»¨í…Œì´ë„ˆ */
        #buildingTextInfo {
            flex-grow: 1;
        }
        
        /* ê±´ë¬¼ ì´ë¦„ */
        #buildingName {
            font-weight: bold;
            font-size: 1rem;
            margin-bottom: 4px;
        }

        /* ì£¼ì†Œ ë° ì˜ì—…ì‹œê°„ í•­ëª© */
        .info-item {
            display: flex;
            align-items: flex-start;
            font-size: 0.85rem;
            color: #555;
            margin-bottom: 2px;
        }
        
        .info-item i {
            width: 14px;
            text-align: center;
            margin-right: 5px;
            line-height: 1.5; /* í…ìŠ¤íŠ¸ì™€ ì‹¬ë³¼ ë†’ì´ ë§ì¶”ê¸° */
        }
        
        /* ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´ í•­ëª© ìŠ¤íƒ€ì¼ */
        .access-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .access-status {
            font-weight: 600;
            min-width: 40px;
            text-align: right;
        }

        .status-positive {
            color: #10b981;
        }

        .status-negative {
            color: #ef4444;
        }

    </style>
</head>
<body>
    <div id="map"></div>
    
    <div id="searchBox">
        <button id="hamburgerBtn" title="ë©”ë‰´">
            <span class="burger-line"></span>
            <span class="burger-line"></span>
            <span class="burger-line"></span>
        </button>
        <div id="searchPlaceholder">ê±´ë¬¼ì´ë¦„ì„ ê²€ìƒ‰í•˜ì„¸ìš”</div>
        <input type="text" id="searchInput" placeholder="ê±´ë¬¼ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”">
        <button id="searchBtn" class="search-icon-btn" title="ê²€ìƒ‰">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
            </svg>
        </button>
        <button id="closeSearchBtn" class="search-icon-btn" title="ê²€ìƒ‰ ì·¨ì†Œ">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
            </svg>
        </button>
    </div>
    
    <div id="coordDisplay" 
class="outdoor-mode-coord">ê±´ë¬¼ì„ 
 í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”</div>
    
    <div id="searchListContainer">
        </div>
 
    <button id="geolocationBtn" class="map-btn-circle" title="í˜„ì¬ ìœ„ì¹˜ ì°¾ê¸°"><span class="geo-icon"></span></button>
    
    <div id="floorControls">
        <button id="accessInfoBtn" class="floor-btn map-btn-circle" data-floor="access" title="ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´"><span class="i-icon"></span></button>
        </div>

    <div id="accessPopup" style="display:none;">
        <span id="accessPopupClose" style="position:absolute; top:6px; right:10px; font-size:22px; cursor:pointer;
color:#777;">Ã—</span>
        
        <div id="accessPopupBody">
            <div id="buildingInfoSection" class="popup-section">
                </div>
            
            <div id="accessFacilitySection" class="popup-section">
                </div>
        </div>
  
       </div>

    <script>
        
        var NCP_KEY_ID = 'q1d23mmkof';
        var script = document.createElement('script');
        script.src = 'https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=' + NCP_KEY_ID + '&vmode=3';

        script.onload = function () 
{
            // ì „ì—­ DOM ìš”ì†Œ ë³€ìˆ˜
            var mapContainer = document.getElementById('map');
            var searchBox = document.getElementById('searchBox'); 
            var coordDisplay = document.getElementById('coordDisplay');
  
            // ê²€ìƒ‰ ê´€ë ¨ DOM ìš”ì†Œ ë³€ìˆ˜
            var searchPlaceholder = document.getElementById('searchPlaceholder');
            var searchInput = document.getElementById('searchInput');
            var searchBtn = document.getElementById('searchBtn');
            var closeSearchBtn = document.getElementById('closeSearchBtn');
            var searchListContainer = document.getElementById('searchListContainer'); 
    searchListContainer.addEventListener('touchstart', function () {
    if (document.activeElement === searchInput) {
        searchInput.blur();
    }
});

            var floorControlsContainer = document.getElementById('floorControls');
            var popup = document.getElementById('accessPopup');
            var buildingInfoSection = document.getElementById('buildingInfoSection');
            var accessFacilitySection = document.getElementById('accessFacilitySection');
            
            var accessBtn = document.getElementById('accessInfoBtn');
            var popupClose = document.getElementById('accessPopupClose');
            var geolocationBtn = document.getElementById('geolocationBtn');
            
            // ì§€ë„ ì˜µì…˜
            var mapOptions = {
                center: new naver.maps.LatLng(37.5710, 126.9784),
                zoom: 17, 
                zoomControl: false, 
                scrollWheelZoom: false, 
                pinchZoom: true,
                mapTypes: new naver.maps.MapTypeRegistry({
               normal: naver.maps.NaverStyleMapTypeOptions.getVectorMap(),
               
  }),
            
};
            // ì§€ë„ ì´ˆê¸°í™”
            var map = new naver.maps.Map('map', mapOptions);
            map.setMapTypeId('normal');
            var labelLayer = new naver.maps.LabelLayer();
            labelLayer.setMap(map);

            // ë§ˆìš°ìŠ¤ íœ  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ (ë¯¸ì„¸ ì¡°ì •)
            var ZOOM_STEP = 0.1;
            mapContainer.addEventListener("wheel", function (e) {
                e.preventDefault();     

                var currentZoom = map.getZoom();
                var newZoom = currentZoom;

                if (e.deltaY < 0) newZoom += ZOOM_STEP;   
         
 
                else newZoom -= ZOOM_STEP;                

                newZoom = Math.round(newZoom * 100) / 100;
                newZoom = Math.min(Math.max(newZoom, 1), 21);

                map.setZoom(newZoom);
            }, { passive: false });
            
            var groundOverlay = null; 
            var currentBuildingId = null; 
            var currentPositionMarker = null;
            
            // =========================================================
            // ë¹Œë”©ë³„ ë°ì´í„° ì •ì˜ (ì¸µë³„ ê²½ê³„ ë¶„ë¦¬ ì ìš©)
            // =========================================================
            var ky_default_bounds = new naver.maps.LatLngBounds(
                new naver.maps.LatLng(37.570512, 126.977632), // ê¸°ì¡´ SW
                new naver.maps.LatLng(37.571415, 126.978244)  // ê¸°ì¡´ NE
            );
            var dt_default_bounds = new naver.maps.LatLngBounds(
                new naver.maps.LatLng(37.570459, 126.978649), 
                new naver.maps.LatLng(37.571626, 126.979210)  
            );

            var buildings = {
                'ky': { // ê±´ë¬¼ 1 (ì˜ˆì‹œ: êµë³´ë¹Œë”©)
                    polygonCoords: [
                        new naver.maps.LatLng(37.571350, 126.977670),
                        new naver.maps.LatLng(37.571360, 126.978059),
                        new naver.maps.LatLng(37.571275, 126.978063),
                        new naver.maps.LatLng(37.571275, 126.978173),
                        new naver.maps.LatLng(37.570870, 126.978184),
                        new naver.maps.LatLng(37.570872, 126.978082),
                        new naver.maps.LatLng(37.570543, 126.978094),
                        new naver.maps.LatLng(37.570539, 126.977702),
                    ],
                    floors: ['b1', '1f', '2f'],
                    images: {
                        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/kb/kb_b11.jpg',
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/kb/ky11.png', 
                        '2f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/kb/ky_1.jpg',
                    },
                    // ì¸µë³„ ê²½ê³„ ì •ë³´ë¥¼ ê°ì²´ë¡œ ë¶„ë¦¬í•˜ì—¬ ì €ì¥
                    floorBounds: { 
                        'b1': new naver.maps.LatLngBounds( // B1: ì‚¬ìš©ìê°€ ìš”ì²­í•œ ìƒˆë¡œìš´ ê²½ê³„
                            new naver.maps.LatLng(37.571590, 126.978531), // SW
                            new naver.maps.LatLng(37.570465, 126.977552)  // NE
                        ),
                        '1f': ky_default_bounds, // 1F: ê¸°ì¡´ ê²½ê³„ ì‚¬ìš©
                        '2f': ky_default_bounds, // 2F: ê¸°ì¡´ ê²½ê³„ ì‚¬ìš©
                    },
                    currentFloor: '1f', 
                    polygon: null,
                    accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': true,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': false,
                        'ì§•ì• ì¸ ì£¼ì°¨ì¥': true,
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´
                    buildingInfo: {
                        name: 'êµë³´ë¹Œë”©',
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/kb/kyobo_gwanghwamun.jpg', 
                        address: 'ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬ ì¢…ë¡œ 1',
                        operating_hours: '09:00 - 18:00 (ì›”ìš”ì¼ íœ´ë¬´)'
                    }
                },
                'dt': { 
                    // ê±´ë¬¼ 2 (ì˜ˆì‹œ: ê´‘í™”ë¬¸ Díƒ€ì›Œ)
                    polygonCoords: [
                        new naver.maps.LatLng(37.571470, 126.978762),
                        new naver.maps.LatLng(37.571476, 126.979161),
                        new naver.maps.LatLng(37.570627, 126.979181),
                        new naver.maps.LatLng(37.570557, 126.979117),
                        new naver.maps.LatLng(37.570553, 126.978777),
                    ],
                    floors: ['b4', '1f'], 
                    images: {
                        'b4': 'https://raw.githubusercontent.com/candream99/disabledmap/main/dt/dt_b4.png',
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/dt/dt1.png',
                    },
                    // ì¸µë³„ ê²½ê³„ ì •ë³´ë¥¼ ê°ì²´ë¡œ ë¶„ë¦¬í•˜ì—¬ ì €ì¥
                    floorBounds: { 
                        'b4': dt_default_bounds, // B4: ê¸°ì¡´ ê²½ê³„ ì‚¬ìš©
                        '1f': dt_default_bounds, // 1F: ê¸°ì¡´ ê²½ê³„ ì‚¬ìš©
                    },
                    currentFloor: '1f',
                    polygon: null,
                    accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': false,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': true, 
                        'ì¥ì• ì¸ ì£¼ì°¨ì¥': false,
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': true 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´
                    buildingInfo: {
                        name: 'ê´‘í™”ë¬¸ Díƒ€ì›Œ',
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/dt/d_tower.jpg', 
                        address: 'ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬ ì¢…ë¡œ3ê¸¸ 17',
                        operating_hours: '10:00 - 21:00 (ë§¤ì¼ ìš´ì˜)'
                    }
                },
                't8': { // ê±´ë¬¼ 3: íƒ€ì›Œ8
                    polygonCoords: [
                        new naver.maps.LatLng(37.570859, 126.980318),
                        new naver.maps.LatLng(37.570854, 126.980784),
                        new naver.maps.LatLng(37.570515, 126.980785),
                        new naver.maps.LatLng(37.570514, 126.980841),
                        new naver.maps.LatLng(37.570417, 126.980840),
                        new naver.maps.LatLng(37.570418, 126.980288),
                        new naver.maps.LatLng(37.570518, 126.980287),
                        new naver.maps.LatLng(37.570518, 126.980315),
                    ],
                    floors: ['b2', 'b1', '1f'], // ìš”ì²­í•˜ì‹  ì¸µë³„ ë²„íŠ¼ ìˆœì„œ
                    images: {
                        'b2': 'https://raw.githubusercontent.com/candream99/disabledmap/main/T8/T8_b2.png',
                        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/T8/T8_b1.png',
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/T8/T8_1.png',
                    },
                    // ì¸µë³„ ê²½ê³„ ì •ë³´ë¥¼ ê°ì²´ë¡œ ë¶„ë¦¬í•˜ì—¬ ì €ì¥
                    floorBounds: { 
                        // ìš”ì²­í•˜ì‹  ë™ì¼í•œ ë¶ë™(NE) ë° ë‚¨ì„œ(SW) ì¢Œí‘œë¥¼ ëª¨ë“  ì¸µì— ì ìš©
                        'b2': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.570405, 126.980209), // SW
                            new naver.maps.LatLng(37.570902, 126.981077)  // NE
                        ),
                        'b1': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.570405, 126.980209), // SW
                            new naver.maps.LatLng(37.570902, 126.981077)  // NE
                        ),
                        '1f': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.570405, 126.980209), // SW
                            new naver.maps.LatLng(37.570902, 126.981077)  // NE
                        ),
                    },
                    currentFloor: '1f',
                    polygon: null,
                    // ì„ì˜ì˜ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´
                    accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': false,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': true, 
                        'ì¥ì• ì¸ ì£¼ì°¨ì¥': true,
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´
                    buildingInfo: {
                        name: 'íƒ€ì›Œ8',
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/T8/t88.jpg', 
                        address: 'ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬ ì¢…ë¡œ5ê¸¸ 7',
                        operating_hours: '09:00 - 22:00 (ì£¼ë§ í¬í•¨)'
                    }
                },
                'dp': { // ê±´ë¬¼ (ì‚¬ìš©ì ìš”ì²­ ì¶”ê°€): ë•ìˆ˜ê¶ ë””íŒ°ë¦¬ìŠ¤
                    polygonCoords: [
                        new naver.maps.LatLng(37.568747, 126.971657),
                        new naver.maps.LatLng(37.568764, 126.971716),
                        new naver.maps.LatLng(37.568785, 126.971707),
                        new naver.maps.LatLng(37.568924, 126.972264),
                        new naver.maps.LatLng(37.568905, 126.972278),
                        new naver.maps.LatLng(37.568918, 126.972331),
                        new naver.maps.LatLng(37.568654, 126.972437),
                        new naver.maps.LatLng(37.568638, 126.972382),
                        new naver.maps.LatLng(37.568619, 126.972390),
                        new naver.maps.LatLng(37.568479, 126.971828),
                        new naver.maps.LatLng(37.568501, 126.971818),
                        new naver.maps.LatLng(37.568483, 126.971760),
                    ],
                    floors: ['1f', 'b1', 'b3'], // 1F, B1, B3 ë²„íŠ¼ ìƒì„±
                    images: {
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/dp/dp_1.png',
                        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/dp/dp_2.png',
                        'b3': 'https://raw.githubusercontent.com/candream99/disabledmap/main/dp/dp_3.png',
                    },
                    // ì¸µë³„ ì´ë¯¸ì§€ ê²½ê³„ ì •ë³´
                    floorBounds: { 
                        '1f': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.568384, 126.971603), // 1F SW
                            new naver.maps.LatLng(37.569001, 126.972464)  // 1F NE
                        ),
                        'b1': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.568245, 126.971606), // B1 SW
                            new naver.maps.LatLng(37.569161, 126.972561)  // B1 NE
                        ),
                        'b3': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.568245, 126.971606), // B3 SW
                            new naver.maps.LatLng(37.569161, 126.972561)  // B3 NE
                        ),
                    },
                    currentFloor: '1f',
                    polygon: null,
                    // ì„ì˜ì˜ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´
                    accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': false,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': true,
                        'ì¥ì• ì¸ ì£¼ì°¨ì¥': true,
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´ (ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë° íŒì—…ìš©)
                    buildingInfo: {
                        name: 'ë•ìˆ˜ê¶ ë””íŒ°ë¦¬ìŠ¤',
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/dp/dp.png', // ê²€ìƒ‰ ë° íŒì—… ì´ë¯¸ì§€
                        address: 'ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬ ìƒˆë¬¸ì•ˆë¡œ2ê¸¸ 10', // ì„ì˜ ì£¼ì†Œ
                        operating_hours: '09:00 - 21:00 (ë§¤ì¼ ìš´ì˜)' // ì„ì˜ ìš´ì˜ì‹œê°„
                    }
                },
                'officia': { // ê±´ë¬¼ 4: ê´‘í™”ë¬¸ ì˜¤í”¼ì‹œì•„
    polygonCoords: [
        new naver.maps.LatLng(37.569884, 126.974610), // ìœ„ë„, ê²½ë„
        new naver.maps.LatLng(37.569882, 126.975265),
        new naver.maps.LatLng(37.569580, 126.975261),
        new naver.maps.LatLng(37.569581, 126.974603),
    ],
    floors: ['b2', 'b1', '1f'], // ìš”ì²­í•˜ì‹  ì¸µ: B2, B1, 1F
    images: {
        // ëª¨ë“  ì¸µì— ë™ì¼í•œ ì´ë¯¸ì§€ URL ì ìš©
        'b2': 'https://raw.githubusercontent.com/candream99/disabledmap/main/officia/officia_b1.png',
        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/officia/officia_b1.png',
        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/officia/officia_1f.png',
    },
    // ì¸µë³„ ê²½ê³„ ì •ë³´ (ìš”ì²­í•˜ì‹  ëŒ€ë¡œ ì¸µë§ˆë‹¤ ë¶„ë¦¬í•˜ì—¬ ë™ì¼í•œ ê²½ê³„ ì ìš©)
    floorBounds: { 
        'b2': new naver.maps.LatLngBounds(
            new naver.maps.LatLng(37.569519, 126.974473), // SW (ë‚¨ì„œ)
            new naver.maps.LatLng(37.569976, 126.975331)  // NE (ë¶ë™)
        ),
        'b1': new naver.maps.LatLngBounds(
            new naver.maps.LatLng(37.569519, 126.974473), // SW
            new naver.maps.LatLng(37.569976, 126.975331)  // NE
        ),
        '1f': new naver.maps.LatLngBounds(
            new naver.maps.LatLng(37.569519, 126.974473), // SW
            new naver.maps.LatLng(37.569976, 126.975331)  // NE
        ),
    },
    currentFloor: '1f',
    polygon: null,
    // ì„ì˜ì˜ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´
    accessInfo: {
        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': false,
        'ì¥ì• ì¸ í™”ì¥ì‹¤': false, 
        'ì¥ì• ì¸ ì£¼ì°¨ì¥': true,
        'ì—˜ë¦¬ë² ì´í„°': true,
        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
    },
    // ê±´ë¬¼ ìƒì„¸ ì •ë³´ (ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë° íŒì—…ìš©)
    buildingInfo: {
        name: 'ê´‘í™”ë¬¸ ì˜¤í”¼ì‹œì•„',
        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/officia/officia_.jpg', // Ië²„íŠ¼ íŒì—… ë° ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ì´ë¯¸ì§€
        address: 'ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬ ìƒˆë¬¸ì•ˆë¡œ 92',
        operating_hours: '10:00 - 21:00 (ì£¼ë§ íœ´ë¬´, ì„ì˜)'
    }
},
                'st': { // ê±´ë¬¼ 5: Síƒ€ì›Œ
    polygonCoords: [
        new naver.maps.LatLng(37.569910, 126.973684), // ìœ„ë„, ê²½ë„
        new naver.maps.LatLng(37.569904, 126.974217),
        new naver.maps.LatLng(37.569688, 126.974214),
        new naver.maps.LatLng(37.569688, 126.973680),
    ],
    floors: ['b2', 'b1', '1f'], // ìš”ì²­í•˜ì‹  ì¸µ: B2, B1, 1F
    images: {
        // ëª¨ë“  ì¸µì— ë™ì¼í•œ ì´ë¯¸ì§€ URL ì ìš©
        'b2': 'https://raw.githubusercontent.com/candream99/disabledmap/main/st/st_b1.png',
        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/st/st_b1.png',
        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/st/st_1.png',
    },
    // ì¸µë³„ ê²½ê³„ ì •ë³´ (ìš”ì²­í•˜ì‹  ëŒ€ë¡œ ì¸µë§ˆë‹¤ ë¶„ë¦¬í•˜ì—¬ ë™ì¼í•œ ê²½ê³„ ì ìš©)
    floorBounds: { 
        'b2': new naver.maps.LatLngBounds(
            new naver.maps.LatLng(37.569473, 126.973510), // SW (ë‚¨ì„œ)
            new naver.maps.LatLng(37.569981, 126.974348)  // NE (ë¶ë™)
        ),
        'b1': new naver.maps.LatLngBounds(
            new naver.maps.LatLng(37.569473, 126.973510), // SW
            new naver.maps.LatLng(37.569981, 126.974348)  // NE
        ),
        '1f': new naver.maps.LatLngBounds(
            new naver.maps.LatLng(37.569473, 126.973510), // SW
            new naver.maps.LatLng(37.569981, 126.974348)  // NE
        ),
    },
    currentFloor: '1f',
    polygon: null,
    // ì„ì˜ì˜ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´
    accessInfo: {
        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': true,
        'ì¥ì• ì¸ í™”ì¥ì‹¤': false, 
        'ì¥ì• ì¸ ì£¼ì°¨ì¥': true,
        'ì—˜ë¦¬ë² ì´í„°': true,
        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
    },
    // ê±´ë¬¼ ìƒì„¸ ì •ë³´ (ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë° íŒì—…ìš©)
    buildingInfo: {
        name: 'Síƒ€ì›Œ',
        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/st/s_t.jpg', // Ië²„íŠ¼ íŒì—… ë° ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ì´ë¯¸ì§€
        address: 'ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬ ìƒˆë¬¸ì•ˆë¡œ 82',
        operating_hours: 'í‰ì¼ 09:00 - 21:00 (ì„ì˜)'
    }
},
                'yp': { // ê±´ë¬¼ 6: ì˜í’ë¹Œë”© (ì‚¬ìš©ì ìš”ì²­ ì¶”ê°€)
                    polygonCoords: [
                        new naver.maps.LatLng(37.569881, 126.981938),
                        new naver.maps.LatLng(37.569879, 126.982329),
                        new naver.maps.LatLng(37.569829, 126.982332),
                        new naver.maps.LatLng(37.569828, 126.982395),
                        new naver.maps.LatLng(37.569780, 126.982395),
                        new naver.maps.LatLng(37.569777, 126.982463),
                        new naver.maps.LatLng(37.569463, 126.982461),
                        new naver.maps.LatLng(37.569462, 126.982068),
                        new naver.maps.LatLng(37.569565, 126.981938),
                    ],
                    floors: ['b1', '1f'], // ìš”ì²­í•˜ì‹  ì¸µ: B1, 1F
                    images: {
                        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/yp/yp1.png', // ëª¨ë“  ì¸µ ë™ì¼ ì´ë¯¸ì§€
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/yp/yp1.png',
                    },
                    // ì¸µë³„ ê²½ê³„ ì •ë³´ (ìš”ì²­í•˜ì‹  ë™ì¼í•œ ë¶ë™(NE) ë° ë‚¨ì„œ(SW) ì¢Œí‘œë¥¼ ëª¨ë“  ì¸µì— ì ìš©)
                    floorBounds: { 
                        'b1': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.569438, 126.981870), // SW: ìœ„ë„: 37.569438, ê²½ë„: 126.981870
                            new naver.maps.LatLng(37.569943, 126.982556)  // NE: ìœ„ë„: 37.569943, ê²½ë„: 126.982556
                        ),
                        '1f': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.569438, 126.981870), // SW
                            new naver.maps.LatLng(37.569943, 126.982556)  // NE
                        ),
                    },
                    currentFloor: '1f',
                    polygon: null,
                    // ì„ì˜ì˜ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´
                    accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': true,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': false, 
                        'ì¥ì• ì¸ ì£¼ì°¨ì¥': true, // ì„ì˜
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': true 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´ (ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë° íŒì—…ìš©)
                    buildingInfo: { 
                        name: 'ì˜í’ë¹Œë”©', 
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/yp/yp_i.jpg', // Ië²„íŠ¼ íŒì—… ë° ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ì´ë¯¸ì§€
                        address: 'ì„œìš¸ ì¢…ë¡œêµ¬ ì²­ê³„ì²œë¡œ 41 (ì„ì˜ ì£¼ì†Œ)', 
                        operating_hours: '09:00 - 22:00 (ì„ì˜)'
                    }
                },
                'sc': { // ê±´ë¬¼ 6: ì œì¼ì€ë¹Œë”© (ì‚¬ìš©ì ìš”ì²­ ì¶”ê°€)
                    polygonCoords: [
                        new naver.maps.LatLng(37.571274, 126.982109),
                        new naver.maps.LatLng(37.571257, 126.982778),
                        new naver.maps.LatLng(37.570935, 126.982765),
                        new naver.maps.LatLng(37.570934, 126.982725),
                        new naver.maps.LatLng(37.570863, 126.982721),
                        new naver.maps.LatLng(37.570672, 126.982456),
                        new naver.maps.LatLng(37.570674, 126.982384),
                        new naver.maps.LatLng(37.570612, 126.982302),
                        new naver.maps.LatLng(37.570616, 126.982153),
new naver.maps.LatLng(37.570712, 126.982050),
new naver.maps.LatLng(37.570974, 126.982058),
new naver.maps.LatLng(37.570969, 126.982094),
                    ],
                    floors: ['b1', '1f'], // ìš”ì²­í•˜ì‹  ì¸µ: B1, 1F
                    images: {
                        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/sc/sc_1.png', // ëª¨ë“  ì¸µ ë™ì¼ ì´ë¯¸ì§€
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/sc/sc_1.png',
                    },
                    // ì¸µë³„ ê²½ê³„ ì •ë³´ (ìš”ì²­í•˜ì‹  ë™ì¼í•œ ë¶ë™(NE) ë° ë‚¨ì„œ(SW) ì¢Œí‘œë¥¼ ëª¨ë“  ì¸µì— ì ìš©)
                    floorBounds: { 
                        'b1': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.570605, 126.981884), // SW: ìœ„ë„: 37.569438, ê²½ë„: 126.981870
                            new naver.maps.LatLng(37.571639, 126.982899)  // NE: ìœ„ë„: 37.569943, ê²½ë„: 126.982556
                        ),
                        '1f': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.570605, 126.981884), // SW
                            new naver.maps.LatLng(37.571639, 126.982899)  // NE
                        ),
                    },
                    currentFloor: '1f',
                    polygon: null,
                    // ì„ì˜ì˜ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´
                    accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': false,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': false, 
                        'ì¥ì• ì¸ ì£¼ì°¨ì¥': true, // ì„ì˜
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´ (ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë° íŒì—…ìš©)
                    buildingInfo: { 
                        name: 'SCì œì¼ì€í–‰', 
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/sc/sc_i.jpg', // Ië²„íŠ¼ íŒì—… ë° ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ì´ë¯¸ì§€
                        address: 'ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬ ì¢…ë¡œ 47', 
                        operating_hours: '09:00 - 16:00'
                    }
                },
                'ks': { // í•œêµ­ë¬´ì—­ë³´í—˜ê³µì‚¬ (K-SURE)
                    polygonCoords: [
                        // ì™¸ê³½ì„  ì¢Œí‘œ (ì‹œê³„ë°©í–¥: NE-SE-SW-NWì™€ ìœ ì‚¬)
                        new naver.maps.LatLng(37.569913, 126.978610), // ìœ„ë„: 37.569913, ê²½ë„: 126.978610
                        new naver.maps.LatLng(37.569910, 126.979151), // ìœ„ë„: 37.569910, ê²½ë„: 126.979151
                        new naver.maps.LatLng(37.569719, 126.979148), // ìœ„ë„: 37.569719, ê²½ë„: 126.979148
                        new naver.maps.LatLng(37.569722, 126.978609)  // ìœ„ë„: 37.569722, ê²½ë„: 126.978609
                    ],
                    floors: ['b2', 'b1', '1f'], 
                    images: {
                        'b2': 'https://raw.githubusercontent.com/candream99/disabledmap/main/ks/ks_b12.png',
                        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/ks/ks_b11.png',
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/ks/ks_1.png',
                    },
                    // ì¸µë³„ ì´ë¯¸ì§€ ê²½ê³„ ì •ë³´ (LatLngBounds: SW, NE ìˆœì„œ)
                    floorBounds: { 
                        // B2 ì´ë¯¸ì§€ ê²½ê³„ (B2, B1ì€ ë™ì¼)
                        'b2': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.569583, 126.978495), // SW: ìœ„ë„: 37.569583, ê²½ë„: 126.978495
                            new naver.maps.LatLng(37.570013, 126.979220)  // NE: ìœ„ë„: 37.570013, ê²½ë„: 126.979220
                        ),
                        // B1 ì´ë¯¸ì§€ ê²½ê³„
                        'b1': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.569583, 126.978495), // SW
                            new naver.maps.LatLng(37.570013, 126.979220)  // NE
                        ),
                        // 1F ì´ë¯¸ì§€ ê²½ê³„
                        '1f': new naver.maps.LatLngBounds( 
                            new naver.maps.LatLng(37.569618, 126.978522), // SW: ìœ„ë„: 37.569618, ê²½ë„: 126.978522
                            new naver.maps.LatLng(37.570012, 126.979214)  // NE: ìœ„ë„: 37.570012, ê²½ë„: 126.979214
                        ),
                    },
                    currentFloor: '1f',
                    polygon: null,
                    // ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´ (ìš”ì²­ì— ë”°ë¼ ì„ì˜ì˜ ê°’ ì„¤ì •)
                    accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': true,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': false, 
                        'ì¥ì• ì¸ ì£¼ì°¨ì¥': true,
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': true 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´ (ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë° íŒì—…ìš©)
                    buildingInfo: {
                        name: 'í•œêµ­ë¬´ì—­ë³´í—˜ê³µì‚¬',
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/ks/ks.jpg', 
                        address: 'ì„œìš¸íŠ¹ë³„ì‹œ ì¢…ë¡œêµ¬ ì¢…ë¡œ 14',
                        operating_hours: 'ì˜¤ì „9ì‹œë¶€í„° ì˜¤í›„ 6ì‹œê¹Œì§€'
                    }
                }
            };

            // =========================================================
            // ëª¨ë°”ì¼ í„°ì¹˜ ì´ë²¤íŠ¸ ë²„ë¸”ë§/ìŠ¤í¬ë¡¤ ë°©ì§€
            // =========================================================

            function preventTouchMove(elementId) {
                var element = document.getElementById(elementId);
 
                if (element) {
                    element.addEventListener('touchmove', function(e) {
                        e.preventDefault();
                    }, { passive: false });
                }
            }

            preventTouchMove('searchBox');
            preventTouchMove('floorControls');
                        
            // =========================================================
            // í•µì‹¬ ë¡œì§ í•¨ìˆ˜
            // =========================================================

            /**
             * ì‹¤ë‚´ ëª¨ë“œ ì§„ì… ì‹œ UI ë³€ê²½
             */
            function enterIndoorMode(buildingId) {
                // ê²€ìƒ‰ ëª¨ë“œ ì¢…ë£Œ
                exitSearchMode(); 
            
                searchBox.style.display = 'none';
                coordDisplay.style.top = '10px';
                
                var config = buildings[buildingId];
                if (config && config.polygonCoords && config.polygonCoords.length > 0) {
                    var bounds = new naver.maps.LatLngBounds();
                    config.polygonCoords.forEach(function(coord) { bounds.extend(coord); });
                    
                    var centerPoint = bounds.getCenter();
                    map.setCenter(centerPoint);
                    map.setZoom(18); 
                }
                
                currentBuildingId = buildingId;
                labelLayer.setMap(null);
                floorControlsContainer.style.display = 'flex';
                coordDisplay.textContent = 'ì¼ë°˜ì§€ë„ë¡œ ëŒì•„ê°€ë ¤ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ í´ë¦­í•˜ì„¸ìš”';
            }

            /**
             * ì‹¤ë‚´ ëª¨ë“œë¥¼ ì¢…ë£Œí•˜ê³  ì¼ë°˜ ì§€ë„ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.
             */
            function exitIndoorMode() {
                if (!currentBuildingId) return;
                if (groundOverlay) {
                    groundOverlay.setMap(null);
                }
                
                // íŒì—…ì°½ ë‹«ê¸° ë° 'i' ë²„íŠ¼ active í•´ì œ
                popup.style.display = 'none';
                accessBtn.classList.remove('active');
                
                // ëª¨ë“  ê±´ë¬¼ í´ë¦¬ê³¤ ë³µì›
                for (var id in buildings) {
                    if (buildings[id].polygon) {
                        buildings[id].polygon.setMap(map);
                        buildings[id].polygon.setOptions({ fillColor: 'transparent' }); 
                    }
                }
            
                floorControlsContainer.style.display = 'none';
                labelLayer.setMap(map);
                currentBuildingId = null; 
            
                // ì¼ë°˜ ëª¨ë“œë¡œ ë³µê·€ ì‹œ UI ë³€ê²½
                searchBox.style.display = 'flex';
                coordDisplay.style.top = '78px';
                coordDisplay.textContent = 'ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”';
            }

            // ì¸µ ì§€ë„(GroundOverlay) í‘œì‹œ (ìˆ˜ì •ëœ ë¶€ë¶„: floorBounds ì‚¬ìš©)
            function showFloor(buildingId, floor) {
                var config = buildings[buildingId];
                // ğŸ’¥ ìˆ˜ì •: config.floorBounds[floor]ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸µë³„ ê²½ê³„ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
                var floorBound = config?.floorBounds[floor];
                
                if (!config || !config.images[floor] || !floorBound) {
                    console.error('í•´ë‹¹ ì¸µì˜ ì´ë¯¸ì§€ ë˜ëŠ” ê²½ê³„ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤:', buildingId, floor);
                    return;
                }

                currentBuildingId = buildingId;
                config.currentFloor = floor; 
                
                if (groundOverlay) groundOverlay.setMap(null);
                // ë‹¤ë¥¸ ê±´ë¬¼ í´ë¦¬ê³¤ ìˆ¨ê¸°ê¸°
                for (var id in buildings) {
                    if (id !== buildingId && buildings[id].polygon) {
                        buildings[id].polygon.setMap(null);
                    }
                }

                // í˜„ì¬ ìœ„ì¹˜ ë§ˆì»¤ê°€ ìˆë‹¤ë©´ ì œê±°
                if (currentPositionMarker) {
                    currentPositionMarker.setMap(null);
                    geolocationBtn.classList.remove('active'); 
                }

                groundOverlay = new naver.maps.GroundOverlay(
                    config.images[floor],
                    floorBound, // ğŸ‘ˆ ì¸µë³„ ê²½ê³„ ì‚¬ìš©
                    {
                        map: map,
                        clickable: true,
                        opacity: 1,
                    }
                );
                // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸: ì¸µ ë²„íŠ¼ë§Œ ë¹„í™œì„±í™” í›„ ì„ íƒëœ ë²„íŠ¼ í™œì„±í™”
                document.querySelectorAll('#floorControls .floor-btn:not(#accessInfoBtn)').forEach(function(btn) { btn.classList.remove('active'); });
                var floorBtn = document.querySelector('#floorControls .floor-btn[data-floor="' + floor + '"]');
                if (floorBtn) floorBtn.classList.add('active');

                // ì‹¤ë‚´ ëª¨ë“œ ì¢…ë£Œ ë¦¬ìŠ¤ë„ˆ (GroundOverlay í´ë¦­ ì‹œ)
                naver.maps.Event.addListener(groundOverlay, 'click', function (e) {
                    e.stopOverlays = true;
                    exitIndoorMode(); 
                });
            }

            // ì¸µ ë²„íŠ¼ ë™ì  ìƒì„± ë° ë Œë”ë§
            function renderFloorButtons(buildingId) {
                var config = buildings[buildingId];
                // ê¸°ì¡´ ì¸µ ë²„íŠ¼ë§Œ ì œê±° (i ë²„íŠ¼ ì œì™¸)
                document.querySelectorAll('#floorControls .floor-btn:not(#accessInfoBtn)').forEach(function(btn) { btn.remove(); });
                var defaultFloor = config.floors.includes('1f') ? '1f' : config.floors[0];
                config.currentFloor = defaultFloor;
                // ìƒˆë¡œìš´ ì¸µ ë²„íŠ¼ ìƒì„± ë° ì¶”ê°€
                config.floors.forEach(function(floor) {
                    var btn = document.createElement('button');
                    btn.className = 'floor-btn map-btn-circle'; 
                    btn.dataset.floor = floor;
                    btn.textContent = floor.toUpperCase();
                    
                    // 'i' ë²„íŠ¼ ë°”ë¡œ ìœ„ì— ì˜¤ë„ë¡ prepend
                    floorControlsContainer.prepend(btn);

                    if (floor === defaultFloor) {
                        btn.classList.add('active');
                    }

                    btn.addEventListener('click', function() {
                       showFloor(buildingId, floor);
                    });
                });
            }

            /**
             * ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´ íŒì—… ë‚´ìš©ì„ ë™ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
             */
            function updateAccessPopup(buildingId) {
                var config = buildings[buildingId];
                var accessInfo = config?.accessInfo;
                var buildingInfo = config?.buildingInfo;
                
                // íŒì—… ë‚´ìš© ì „ì²´ ì´ˆê¸°í™” 
                buildingInfoSection.innerHTML = '';
                accessFacilitySection.innerHTML = '';


                // 1. ê±´ë¬¼ ì •ë³´ ì„¹ì…˜ ë Œë”ë§
                if (buildingInfo) {
                    buildingInfoSection.innerHTML = `
                        <img id="buildingImage" src="${buildingInfo.image_url}" alt="${buildingInfo.name} ì‚¬ì§„">
                        <div id="buildingTextInfo">
                            <div id="buildingName">${buildingInfo.name}</div>
                            <div class="info-item">
                                <i>ğŸ ï¸</i>
                                <span>${buildingInfo.address}</span>
                            </div>
                            <div class="info-item">
                                <i>â—´</i>
                                <span>${buildingInfo.operating_hours}</span>
                            </div>
                        </div>
                    `;
                } else {
                    buildingInfoSection.innerHTML = '<div>ê±´ë¬¼ ê¸°ë³¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                }

                
                // 2. ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´ ì„¹ì…˜ ë Œë”ë§ 
                if (!accessInfo) {
                    accessFacilitySection.innerHTML = '<div>ê±´ë¬¼ì— ëŒ€í•œ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                    return;
                }

                var html = '';
                html += '<div style="font-size:1.0rem; font-weight:700; margin-bottom:12px; color:#1e3a8a;">ë¬´ì¥ì•  ì‹œì„¤ì •ë³´</div>';
                for (var facility in accessInfo) {
                    var isAvailable = accessInfo[facility];
                    var statusText, statusClass;

                    if (facility.includes('ë‹¨ì°¨')) {
                        statusText = isAvailable ? 'ìˆìŒ' : 'ì—†ìŒ';
                        statusClass = isAvailable ? 'status-negative' : 'status-positive'; 
                    } else {
                        statusText = isAvailable ? 'ìˆìŒ' : 'ì—†ìŒ';
                        statusClass = isAvailable ? 'status-positive' : 'status-negative';
                    }

                    html += `
                        <div class="access-item">
                            <span>â€¢ ${facility}</span>
                            <span class="access-status ${statusClass}">${statusText}</span>
                        </div>
                    `;
                }
                accessFacilitySection.innerHTML = html;
            }
            
            // =========================================================
            // ê±´ë¬¼ ê²€ìƒ‰ ë¦¬ìŠ¤íŠ¸ ë° ì´ë™ ë¡œì§ 
            // =========================================================
            
            /**
             * ê±´ë¬¼ ëª©ë¡ì„ ìƒì„±í•˜ì—¬ searchListContainerì— ë Œë”ë§í•˜ê³  í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ì—°ê²°í•©ë‹ˆë‹¤.
             * @param {string} filterQuery - í•„í„°ë§í•  ê²€ìƒ‰ì–´
             */
            function renderBuildingList(filterQuery) { 
                var html = '';
                var isListEmpty = true;
                var normalizedQuery = filterQuery.trim().toLowerCase().replace(/\s/g, ''); 

                for (var id in buildings) {
                    var config = buildings[id];
                    var info = config.buildingInfo;
                    
                    var buildingName = info.name;
                    var buildingAddress = info.address;
                    var buildingHours = info.operating_hours;
                    
                    // í•„í„°ë§ ë¡œì§: ê²€ìƒ‰ì–´ì™€ ì´ë¦„ì´ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
                    var normalizedName = buildingName.trim().toLowerCase().replace(/\s/g, '');
                    if (normalizedQuery && !normalizedName.includes(normalizedQuery)) {
                         continue; // ê²€ìƒ‰ì–´ê°€ ìˆê³  ì´ë¦„ì— í¬í•¨ë˜ì§€ ì•Šìœ¼ë©´ ê±´ë„ˆë›°ê¸°
                    }
                    
                    html += `
                        <div class="search-result-item" data-building-id="${id}" data-building-name="${buildingName}">
                            <img class="result-image" src="${info.image_url}" alt="${buildingName}">
                            <div class="result-text-info">
                                <div class="result-name">${buildingName}</div>
                                <div class="result-info-item">
                                    <i>ğŸ“</i>
                                    <span>${buildingAddress}</span>
                                </div>
                                <div class="result-info-item">
                                    <i>ğŸ•’</i>
                                    <span>${buildingHours}</span>
                                </div>
                            </div>
                        </div>
                    `;
                    isListEmpty = false;
                }

                if (isListEmpty) {
                    searchListContainer.innerHTML = '<div style="padding:10px; color:#555;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                } else {
                    searchListContainer.innerHTML = html;
                }
                
                // ë¦¬ìŠ¤íŠ¸ ì•„ì´í…œì— í´ë¦­ ì´ë²¤íŠ¸ ì—°ê²°
                document.querySelectorAll('.search-result-item').forEach(function(item) {
                    item.addEventListener('click', function() {
                        var buildingId = this.getAttribute('data-building-id');
                        var buildingName = this.getAttribute('data-building-name');
                        searchAndGoToBuilding(buildingName, buildingId);
                    });
                });
            }

            /**
             * ê±´ë¬¼ ì´ë¦„ìœ¼ë¡œ ì§€ë„ë¥¼ í•´ë‹¹ ê±´ë¬¼ ì¤‘ì‹¬ìœ¼ë¡œ ì´ë™ì‹œí‚¤ëŠ” í•¨ìˆ˜
             */
            function searchAndGoToBuilding(buildingName, directId) {
                var foundBuildingId = directId;
                
                if (!foundBuildingId) {
                    // ê²€ìƒ‰ ë²„íŠ¼/Enterë¡œ ê²€ìƒ‰í–ˆì„ ê²½ìš° (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
                    var normalizedName = buildingName.trim().toLowerCase().replace(/\s/g, ''); 
                    for (var id in buildings) { 
                        var configName = buildings[id].buildingInfo.name.trim().toLowerCase().replace(/\s/g, '');
                        if (configName.includes(normalizedName) || normalizedName.includes(configName)) {
                            foundBuildingId = id;
                            break;
                        }
                    }
                }
                
                if (foundBuildingId) {
                    var config = buildings[foundBuildingId];
                    if (config.polygonCoords && config.polygonCoords.length > 0) {
                        var bounds = new naver.maps.LatLngBounds();
                        config.polygonCoords.forEach(function(coord) { bounds.extend(coord); });
                        
                        map.setCenter(bounds.getCenter());
                        map.setZoom(17); 
                        
                        coordDisplay.textContent = `[ê²€ìƒ‰ ì„±ê³µ] '${buildingName}'ë¡œ ì´ë™í–ˆìŠµë‹ˆë‹¤.`;
                        exitSearchMode();
                    }
                } else {
                    coordDisplay.textContent = `[ê²€ìƒ‰ ì‹¤íŒ¨] '${buildingName}'ì— í•´ë‹¹í•˜ëŠ” ê±´ë¬¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ì˜ˆ: êµë³´ë¹Œë”©, Díƒ€ì›Œ)`;
                }
            }

            /**
             * ê²€ìƒ‰ ëª¨ë“œ UIë¡œ ì „í™˜ (ì…ë ¥ í•„ë“œ í™œì„±í™” ë° ëª©ë¡ í‘œì‹œ)
             */
            function enterSearchMode() {
                if (currentBuildingId) {
                    coordDisplay.textContent = 'ì‹¤ë‚´ ëª¨ë“œì—ì„œëŠ” ê²€ìƒ‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì¼ë°˜ ì§€ë„ë¡œ ëŒì•„ê°€ì„¸ìš”.';
                    return;
                }
                searchPlaceholder.style.display = 'none';
                searchInput.style.display = 'block';
                searchBtn.style.display = 'flex';
                closeSearchBtn.style.display = 'flex';
                coordDisplay.textContent = 'ì•„ë˜ ëª©ë¡ì—ì„œ ê±´ë¬¼ì„ ì„ íƒí•˜ê±°ë‚˜ ì´ë¦„ì„ ê²€ìƒ‰í•˜ì„¸ìš”.'; 
                searchInput.focus(); 
                
                // ê±´ë¬¼ ëª©ë¡ ë Œë”ë§ ë° í‘œì‹œ (ë¹ˆ ì¿¼ë¦¬ë¡œ ì „ì²´ ëª©ë¡ í‘œì‹œ)
                renderBuildingList('');
                searchListContainer.style.display = 'block';
            }

            /**
             * ê²€ìƒ‰ ëª¨ë“œ UIë¥¼ ì¢…ë£Œí•˜ê³  ì´ˆê¸° ìƒíƒœë¡œ ë³µì›
             */
            function exitSearchMode() {
                searchInput.value = ''; 
                searchInput.style.display = 'none';
                searchBtn.style.display = 'none';
                closeSearchBtn.style.display = 'none';
                searchPlaceholder.style.display = 'block';
                
                // ê±´ë¬¼ ëª©ë¡ ìˆ¨ê¸°ê¸° ë° ì´ˆê¸°í™”
                searchListContainer.style.display = 'none';
                searchListContainer.innerHTML = '';
                
                coordDisplay.textContent = 'ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”';
            }
            
            // =========================================================
            // ê±´ë¬¼ Polygon ìƒì„± ë° ë¦¬ìŠ¤ë„ˆ ì„¤ì • 
            // =========================================================

            function setupBuilding(buildingId, config) {
                var polygon = new naver.maps.Polygon({
                    map: map,
                    paths: [config.polygonCoords],
                    fillColor: 'transparent',
                    fillOpacity: 0.5,
                    strokeColor: '#C490E4',
                    strokeOpacity: 1,
                    strokeWeight: 2,
                    clickable: true,
                });
                config.polygon = polygon; 

                // ë§ˆìš°ìŠ¤ ì˜¤ë²„ ë¦¬ìŠ¤ë„ˆ 
                naver.maps.Event.addListener(polygon, 'mouseover', function() {
                    if (!groundOverlay || groundOverlay.getMap() === null) {
                        polygon.setOptions({ fillColor: '#C490E4' });
                        coordDisplay.textContent = 'í´ë¦­í•´ì„œ ì‹¤ë‚´ì§€ë„ë¥¼ ë³´ì„¸ìš”';
                    }
                });
                // ë§ˆìš°ìŠ¤ ì•„ì›ƒ ë¦¬ìŠ¤ë„ˆ 
                naver.maps.Event.addListener(polygon, 'mouseout', function() {
                    if (!groundOverlay || groundOverlay.getMap() === null) {
                        polygon.setOptions({ fillColor: 'transparent' });
                        coordDisplay.textContent = 'ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”';
                    }
                });
                // í´ë¦­ ë¦¬ìŠ¤ë„ˆ (ì‹¤ë‚´ ëª¨ë“œ ì§„ì…)
                naver.maps.Event.addListener(polygon, 'click', function (e) {
                    e.stopOverlays = true;
                    
                    enterIndoorMode(buildingId);

                    polygon.setMap(null);
                    
                    if (currentPositionMarker) {
                        currentPositionMarker.setMap(null);
                        geolocationBtn.classList.remove('active'); 
                    }

                    renderFloorButtons(buildingId);
                    
                    var defaultFloor = config.floors.includes('1f') ? '1f' : config.floors[0];
                    showFloor(buildingId, defaultFloor);
                    
                    updateAccessPopup(buildingId); 
                });
            }

            // =========================================================
            // í˜„ì¬ ìœ„ì¹˜ (Geolocation) ê¸°ëŠ¥ 
            // =========================================================
            geolocationBtn.addEventListener('click', function() {
                var isIndoorMode = currentBuildingId !== null; 

                // 1. ì´ë¯¸ í™œì„±í™” ìƒíƒœë¼ë©´ (íŒŒë€ìƒ‰ ë²„íŠ¼) 
                if (geolocationBtn.classList.contains('active')) {
                    if (currentPositionMarker) {
                        currentPositionMarker.setMap(null);
                    }
                    geolocationBtn.classList.remove('active');
                    
                    if (isIndoorMode) {
                        coordDisplay.textContent = 'ì¼ë°˜ì§€ë„ë¡œ ëŒì•„ê°€ë ¤ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ í´ë¦­í•˜ì„¸ìš”';
                    } else {
                        coordDisplay.textContent = 'ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”';
                    }
                    return;
                }

                
                // 2. Geolocation ì‹œì‘
                if (navigator.geolocation) {
                    coordDisplay.textContent = 'í˜„ì¬ ìœ„ì¹˜ë¥¼ ì°¾ëŠ” ì¤‘ì…ë‹ˆë‹¤...';
                    navigator.geolocation.getCurrentPosition(
                        function(position) {
                            var lat = position.coords.latitude;
                            var lng = position.coords.longitude;
                            var currentLatLng = new naver.maps.LatLng(lat, lng);

                            map.setCenter(currentLatLng);
                            map.setZoom(17); 

                            // ê¸°ì¡´ ë§ˆì»¤ ì œê±°
                            if (currentPositionMarker) {
                                currentPositionMarker.setMap(null);
                            }

                            // ìƒˆë¡œìš´ í˜„ì¬ ìœ„ì¹˜ ë§ˆì»¤ ìƒì„± (íŒŒë€ìƒ‰ ë„íŠ¸)
                            currentPositionMarker 
                            = new naver.maps.Marker({
                                map: map,
                                position: currentLatLng,
                                icon: {
                                    content: 
                                        '<div style="width:12px; height:12px; background-color:#007bff; border-radius:50%; border:2px solid #ffffff; box-shadow:0 0 5px rgba(0,0,0,0.5);"></div>',
                                    size: new naver.maps.Size(12, 12),
                                    anchor: new naver.maps.Point(6, 6)
                               },
                                zIndex: 9999
                            });
                            
                            // ë¬¸êµ¬ ì—…ë°ì´íŠ¸
                            if (isIndoorMode) {
                                coordDisplay.textContent = 'í˜„ì¬ ìœ„ì¹˜ë¡œ ì´ë™í–ˆìŠµë‹ˆë‹¤. ì‹¤ë‚´ì§€ë„ëŠ” ê·¸ëŒ€ë¡œ í‘œì‹œë©ë‹ˆë‹¤.';
                            } else {
                                coordDisplay.textContent = 'í˜„ì¬ ìœ„ì¹˜ë¡œ ì´ë™í–ˆìŠµë‹ˆë‹¤! ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”';
                            }
                            geolocationBtn.classList.add('active'); 

                        },
                        function(error) {
                            console.error("Geolocation Error:", error);
                            
                            var errorMsg = 'ìœ„ì¹˜ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ê±°ë‚˜ ì ‘ê·¼ì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.';
                            if (error.code === 1) {
                                errorMsg = 'ìœ„ì¹˜ ì •ë³´ ì ‘ê·¼ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.';
                            } else if (error.code === 2) {
                                errorMsg = 'ìœ„ì¹˜ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
                            }
                            
                            if (isIndoorMode) {
                                coordDisplay.textContent = `[ì—ëŸ¬] ${errorMsg}. ì¼ë°˜ì§€ë„ë¡œ ëŒì•„ê°€ë ¤ë©´ í´ë¦­í•˜ì„¸ìš”`;
                            } else {
                                coordDisplay.textContent = `[ì—ëŸ¬] ${errorMsg}. ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”`;
                            }
                            
                            if (currentPositionMarker) {
                                currentPositionMarker.setMap(null);
                            }
                            geolocationBtn.classList.remove('active');
                        },
                        { enableHighAccuracy: true, timeout: 5000, maximumAge: 0 } 
                    );
                } else {
                    coordDisplay.textContent = 'Geolocation ë¯¸ì§€ì›: ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”';
                }
            });
            
            // =========================================================
            // ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì • 
            // =========================================================

            // ëª¨ë“  ê±´ë¬¼ ì„¤ì •
            for (var id in buildings) {
                setupBuilding(id, buildings[id]);
            }

            // ì§€ë„ í´ë¦­ ë¦¬ìŠ¤ë„ˆ (ê¸°ë³¸ ë¬¸êµ¬ ìœ ì§€ ë° ê²€ìƒ‰ ëª¨ë“œ ì¢…ë£Œ)
            naver.maps.Event.addListener(map, 'click', function (e) {
                if (!groundOverlay || groundOverlay.getMap() === null) {
                     // ê²€ìƒ‰ ëª¨ë“œì¼ ê²½ìš° ê²€ìƒ‰ ëª¨ë“œë¥¼ ì¢…ë£Œ
                    if (searchInput.style.display === 'block') {
                        exitSearchMode();
                    }
                    coordDisplay.textContent = 'ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”';
                }
            });
            
            // ê²€ìƒ‰ í”Œë ˆì´ìŠ¤í™€ë” í´ë¦­ ë¦¬ìŠ¤ë„ˆ (ê²€ìƒ‰ ëª¨ë“œ ì§„ì…)
            searchPlaceholder.addEventListener('click', enterSearchMode);
            
            // ê²€ìƒ‰ ì…ë ¥ í•„ë“œì—ì„œ ì…ë ¥ì´ ë°œìƒí•  ë•Œë§ˆë‹¤ ë¦¬ìŠ¤íŠ¸ë¥¼ í•„í„°ë§
            searchInput.addEventListener('input', function() {
                renderBuildingList(searchInput.value);
            });
            
            // ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ ë¦¬ìŠ¤ë„ˆ (ê²€ìƒ‰ í›„ ì§€ë„ë¡œ ì´ë™)
            searchBtn.addEventListener('click', function() {
                var query = searchInput.value;
                if (query.trim() !== '') {
                    searchAndGoToBuilding(query);
                } else {
                    coordDisplay.textContent = 'ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                }
            });

            // ê²€ìƒ‰ ì…ë ¥ í•„ë“œì—ì„œ Enter í‚¤ ì…ë ¥ ë¦¬ìŠ¤ë„ˆ (ê²€ìƒ‰ í›„ ì§€ë„ë¡œ ì´ë™)
            searchInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    var query = searchInput.value;
                    if (query.trim() !== '') {
                        searchAndGoToBuilding(query);
                    } else {
                        coordDisplay.textContent = 'ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                    }
                }
            });

            // ê²€ìƒ‰ ì·¨ì†Œ ë²„íŠ¼ í´ë¦­ ë¦¬ìŠ¤ë„ˆ
            closeSearchBtn.addEventListener('click', exitSearchMode);

            // ë¬´ì¥ì• ì‹œì„¤ ë²„íŠ¼ ('i' ë²„íŠ¼) í´ë¦­ ë¦¬ìŠ¤ë„ˆ 
            accessBtn.addEventListener('click', function() {
                if (!currentBuildingId) {
                    coordDisplay.textContent = 'ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´ëŠ” ê±´ë¬¼ì„ í´ë¦­í•˜ì—¬ ì‹¤ë‚´ ëª¨ë“œ ì§„ì… í›„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.';
                    return;
                }

                var isOpen = popup.style.display === 'block';
                
                if (!isOpen) {
                    var buttonRect = accessBtn.getBoundingClientRect();
                    var newPopupLeft = buttonRect.right + 5;

                    popup.style.bottom = '20px';
                    popup.style.left = newPopupLeft + 'px'; 
                    
                    popup.style.display = 'block';
                    this.classList.add('active');
                } else {
                    // íŒì—… ë‹«ê¸°
                    popup.style.display = 'none';
                    this.classList.remove('active');
                }
            });
            
            // ë¬´ì¥ì•  ì‹œì„¤ì •ë³´ íŒì—… ë‹«ê¸° ì´ë²¤íŠ¸ (X ë²„íŠ¼ í´ë¦­)
            if (popupClose) {
                popupClose.onclick = function() {
                    popup.style.display = 'none';
                    accessBtn.classList.remove('active');
                };
            }
        };
        // API ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€
        script.onerror = function () {
            console.error('ë„¤ì´ë²„ ì§€ë„ API ë¡œë“œ ì‹¤íŒ¨! URL ë˜ëŠ” Keyë¥¼ í™•ì¸í•˜ì„¸ìš”.');
        };

        document.head.appendChild(script);
        
    </script>
</body>
</html>































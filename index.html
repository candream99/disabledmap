<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ë„¤ì´ë²„ ë²¡í„°ë§µ í…ŒìŠ¤íŠ¸ - ë¬´ì¥ì•  ì‹œì„¤ íŒì—… ìµœì¢…ë³¸</title>
    <style>
        /* ------------------------------------------------ */
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ (ëª¨ë°”ì¼ ìµœì í™”ì—ì„œ ë°ìŠ¤í¬í†± ëŒ€ì‘ìœ¼ë¡œ ë³€ê²½) */
        /* ------------------------------------------------ */
        body { 
            margin: 0;
padding: 0; 
            height: 100vh; 
            font-family: 'Malgun Gothic', sans-serif;
            overflow: auto; /* ë°ìŠ¤í¬í†±ì—ì„œ ìŠ¤í¬ë¡¤ í—ˆìš© */
        }
        
        /* ------------------------------------------------ */
        /* ë°ìŠ¤í¬í†± ëª¨ë“œ ê¸°ë³¸ ë ˆì´ì•„ì›ƒ (768px ì´ìƒ) */
        /* ------------------------------------------------ */
        .desktop-layout {
            display: flex;
            height: 100vh;
        }

        /* ê²€ìƒ‰ íŒ¨ë„ ìŠ¤íƒ€ì¼ */
        #searchPanel {
            width: 380px; /* ë„¤ì´ë²„ ì§€ë„ì™€ ìœ ì‚¬í•œ ë„ˆë¹„ */
            height: 100%;
            background-color: #ffffff;
            z-index: 3000; /* ë§µ ìœ„ì— í‘œì‹œ */
            box-shadow: 2px 0 8px rgba(0,0,0,0.1);
            display: none; /* JSì—ì„œ ë°ìŠ¤í¬í†±ì¼ ê²½ìš° 'flex'ë¡œ ë³€ê²½ */
            flex-direction: column;
        }

        /* ë§µ ì»¨í…Œì´ë„ˆ */
        #map { 
            width: 100%;
height: 100%; 
            flex-grow: 1; /* ë‚¨ì€ ê³µê°„ì„ ëª¨ë‘ ì°¨ì§€ */
        }
        
        /* ê²€ìƒ‰ì°½ (íŒ¨ë„ ë‚´ë¶€) ìŠ¤íƒ€ì¼ */
        #panelSearchBox {
            position: relative;
            padding: 15px;
            background-color: #f8f8f8;
            border-bottom: 1px solid #eee;
        }
        
        #panelSearchInput {
            width: 100%;
            height: 40px;
            padding: 0 15px;
            border: 1px solid #ccc;
            border-radius: 20px;
            font-size: 16px;
            box-sizing: border-box;
            outline: none;
        }
        
        /* ê±´ë¬¼ ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        #buildingList {
            flex-grow: 1;
            overflow-y: auto; /* ê±´ë¬¼ ëª©ë¡ì´ ê¸¸ì–´ì§€ë©´ ìŠ¤í¬ë¡¤ ê°€ëŠ¥ */
            padding: 10px 0;
        }
        
        .building-list-item {
            display: flex;
align-items: flex-start;
            gap: 10px;
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s;
        }

        .building-list-item:hover {
            background-color: #f7f7f7;
        }
        
        .list-item-image {
            width: 80px; 
height: auto;
            object-fit: cover;
border-radius: 4px;
        }

        .list-item-text-info {
            flex-grow: 1;
}
        
        .list-item-name {
            font-weight: bold;
font-size: 1rem;
            margin-bottom: 4px;
            color: #333;
        }

        .list-info-item {
            display: flex;
align-items: flex-start;
            font-size: 0.85rem;
            color: #555;
            margin-bottom: 2px;
        }
        
        .list-info-item i {
            width: 14px;
text-align: center;
            margin-right: 5px;
line-height: 1.5; 
        }
        
        /* ------------------------------------------------ */
        /* ëª¨ë°”ì¼/ê¸°ì¡´ ìŠ¤íƒ€ì¼ ì¡°ì • (ë°ìŠ¤í¬í†± ëª¨ë“œ ëŒ€ì‘) */
        /* ------------------------------------------------ */
        
        /* ëª¨ë°”ì¼ìš© ê²€ìƒ‰ì°½ (ë°ìŠ¤í¬í†±ì—ì„œ ìˆ¨ê¹€) */
        #searchBox {
            display: flex; /* ê¸°ë³¸ê°’ */
            position: absolute;
top: 20px; 
            left: 50%;
            transform: translateX(-50%);
            width: 80vw; 
            max-width: 500px; 
            height: 48px;
            background: #ffffff;
            border-radius: 24px;
box-shadow: 0 6px 16px rgba(0,0,0,0.2); 
            align-items: center;
            padding: 0 15px; 
            z-index: 2000;
}

        /* ë°ìŠ¤í¬í†± ëª¨ë“œ: coordDisplay ìœ„ì¹˜ ë³€ê²½ (ëª¨ë°”ì¼ ì‹¤ë‚´ ëª¨ë“œì™€ ë™ì¼) */
        #coordDisplay.desktop-mode {
            top: 10px !important; /* JSì˜ enterIndoorModeì™€ ë™ì¼í•œ ìœ„ì¹˜ */
            left: 390px !important; /* íŒ¨ë„(380) + 10px */
            transform: translateX(0) !important;
            width: auto !important; /* ë„ˆë¹„ ìë™ */
            max-width: calc(100vw - 400px) !important;
        }
        
        /* ë°ìŠ¤í¬í†± ëª¨ë“œ: Geolocation, FloorControls ìœ„ì¹˜ ë³€ê²½ */
        #geolocationBtn.desktop-mode {
bottom: 18px; 
            left: 390px; /* íŒ¨ë„ ë„ˆë¹„ 380 + 10px */
            z-index: 1500;
        }

        #floorControls.desktop-mode {
bottom: 88px; 
            left: 390px;
            z-index: 1500;
        }

        /* ë°ìŠ¤í¬í†± ëª¨ë“œ: íŒì—… ìœ„ì¹˜ ë³€ê²½ */
        #accessPopup.desktop-mode {
left: 400px !important; /* íŒ¨ë„(380) + 20px */
            max-width: 240px;
            /* ë‚˜ë¨¸ì§€ ìŠ¤íƒ€ì¼ ìœ ì§€ */
        }
        
        /* ê¸°ì¡´ ìŠ¤íƒ€ì¼ì€ ìœ ì§€ */
.map-btn-circle {
            width: 40px;
height: 40px;
            /* ... ê¸°íƒ€ ìŠ¤íƒ€ì¼ ìœ ì§€ ... */
        }
        /* ... ê¸°íƒ€ ìŠ¤íƒ€ì¼ ìœ ì§€ ... */

    </style>
</head>
<body>
    <div class="desktop-layout">
        <div id="searchPanel">
            <div id="panelSearchBox">
                <input type="text" id="panelSearchInput" placeholder="ê±´ë¬¼ ì´ë¦„, ì£¼ì†Œ ê²€ìƒ‰">
            </div>
            <div id="buildingList">
                </div>
        </div>
        
        <div id="map"></div>
    </div>
    
    <div id="searchBox">
        <button id="hamburgerBtn" title="ë©”ë‰´">
            <span class="burger-line"></span>
            <span class="burger-line"></span>
            <span class="burger-line"></span>
        </button>
        <div id="searchPlaceholder">ê±´ë¬¼ì´ë¦„ì„ ê²€ìƒ‰í•˜ì„¸ìš”</div>
    </div>
    
    <div id="coordDisplay" 
class="outdoor-mode-coord">ê±´ë¬¼ì„ 
í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”</div>
    
 
    <button id="geolocationBtn" class="map-btn-circle" title="í˜„ì¬ ìœ„ì¹˜ ì°¾ê¸°"><span class="geo-icon"></span></button>
    
    <div id="floorControls">
        <button id="accessInfoBtn" class="floor-btn map-btn-circle" data-floor="access" title="ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´"><span class="i-icon"></span></button>
        </div>

<div id="accessPopup" style="display:none;">
        <span id="accessPopupClose" style="position:absolute; top:6px; right:10px; font-size:22px; cursor:pointer;
color:#777;">Ã—</span>
        
        <div id="accessPopupBody">
            <div id="buildingInfoSection" class="popup-section">
 
               </div>
            
            <div id="accessFacilitySection" class="popup-section">
                </div>
        </div>
  
       </div>

    <script>
        
        const NCP_KEY_ID = 'q1d23mmkof';
const script = document.createElement('script');
        script.src = `https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=${NCP_KEY_ID}&vmode=3`;

        script.onload = function () 
{
            // ì „ì—­ DOM ìš”ì†Œ ë³€ìˆ˜
            const mapContainer = document.getElementById('map');
const searchBox = document.getElementById('searchBox'); 
            const searchPanel = document.getElementById('searchPanel'); // ì¶”ê°€
            const buildingList = document.getElementById('buildingList'); // ì¶”ê°€
            const coordDisplay = document.getElementById('coordDisplay');
  
            const floorControlsContainer = document.getElementById('floorControls');
            const popup = document.getElementById('accessPopup');
// ìƒˆë¡œ ì¶”ê°€ëœ DOM ìš”ì†Œ ë³€ìˆ˜
            const popupBody = document.getElementById('accessPopupBody');
const buildingInfoSection = document.getElementById('buildingInfoSection');
            const accessFacilitySection = document.getElementById('accessFacilitySection');
            
            const accessBtn = document.getElementById('accessInfoBtn');
            const popupClose = document.getElementById('accessPopupClose');
            const geolocationBtn = document.getElementById('geolocationBtn');
// ì§€ë„ ì˜µì…˜
            const mapOptions = {
                center: new naver.maps.LatLng(37.5710, 126.9784),
                zoom: 17, 
               
                zoomControl: false, 
             

                scrollWheelZoom: false, 
                pinchZoom: true,
                
                mapTypes: new naver.maps.MapTypeRegistry({
               normal: naver.maps.NaverStyleMapTypeOptions.getVectorMap(),
               
 }),
            
};
// ì§€ë„ ì´ˆê¸°í™”
            const map = new naver.maps.Map('map', mapOptions);
map.setMapTypeId('normal');
            const labelLayer = new naver.maps.LabelLayer();
            labelLayer.setMap(map);

            // â˜…â˜…â˜… í•µì‹¬: ë°ìŠ¤í¬í†± ëª¨ë“œ íŒë‹¨ ë¡œì§ (768px ì´ìƒ) â˜…â˜…â˜…
            let isDesktop = window.innerWidth >= 768;

            // ì°½ í¬ê¸° ë³€ê²½ ì‹œ ë°ìŠ¤í¬í†± ëª¨ë“œ ì¬í™•ì¸
            window.addEventListener('resize', () => {
                const wasDesktop = isDesktop;
                isDesktop = window.innerWidth >= 768;
                if (isDesktop && !wasDesktop) {
                    initDesktopMode();
                } else if (!isDesktop && wasDesktop) {
                    // ëª¨ë°”ì¼ ëª¨ë“œë¡œ ëŒì•„ê°ˆ ë•Œ í•„ìš”í•œ ì´ˆê¸°í™” (ì˜µì…˜)
                    exitDesktopMode();
                }
            });

            // ì´ˆê¸° ë°ìŠ¤í¬í†± ëª¨ë“œ ì„¤ì •
            if (isDesktop) {
                initDesktopMode();
            } else {
                // ëª¨ë°”ì¼ ëª¨ë“œì¼ ê²½ìš° ê¸°ì¡´ ìŠ¤í¬ë¡¤ ë°©ì§€ ë¡œì§ ì ìš©
                preventTouchMove('searchBox');
                preventTouchMove('floorControls');
            }
            
            // ë°ìŠ¤í¬í†± ëª¨ë“œ UI ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            function initDesktopMode() {
                // ë°ìŠ¤í¬í†± ëª¨ë“œ UI ì ìš©
                searchBox.style.display = 'none'; // ëª¨ë°”ì¼ìš© ê²€ìƒ‰ì°½ ìˆ¨ê¹€
                searchPanel.style.display = 'flex'; // ê²€ìƒ‰ íŒ¨ë„ í‘œì‹œ
                
                // coordDisplay, ë²„íŠ¼ë“¤ì— ë°ìŠ¤í¬í†± ëª¨ë“œ í´ë˜ìŠ¤ ì ìš©
                coordDisplay.classList.add('desktop-mode');
                geolocationBtn.classList.add('desktop-mode');
                floorControlsContainer.classList.add('desktop-mode');
                popup.classList.add('desktop-mode');

                // coordDisplay ìœ„ì¹˜ë¥¼ ì‹¤ë‚´ ëª¨ë“œ ìœ„ì¹˜ë¡œ ë°”ë¡œ ì´ë™
                coordDisplay.style.top = '10px';
                coordDisplay.style.left = '390px'; 
                coordDisplay.textContent = 'ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”'; 

                // ê±´ë¬¼ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ ë° ì´ë²¤íŠ¸ ì„¤ì •
                renderBuildingList();
            }

            // ëª¨ë°”ì¼ ëª¨ë“œ ë³µê·€ ì‹œ UI ì´ˆê¸°í™” (í•„ìš”í•˜ë‹¤ë©´)
            function exitDesktopMode() {
                searchBox.style.display = 'flex'; 
                searchPanel.style.display = 'none'; 
                
                coordDisplay.classList.remove('desktop-mode');
                geolocationBtn.classList.remove('desktop-mode');
                floorControlsContainer.classList.remove('desktop-mode');
                popup.classList.remove('desktop-mode');

                // ê¸°ì¡´ ëª¨ë°”ì¼ ìœ„ì¹˜ë¡œ ë³µì› (searchBox ì•„ë˜)
                coordDisplay.style.top = '78px';
                coordDisplay.style.left = '50%';
                coordDisplay.textContent = 'ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”'; 

                // ëª¨ë°”ì¼ ëª¨ë“œ ìŠ¤í¬ë¡¤ ë°©ì§€ ì¬ì ìš©
                preventTouchMove('searchBox');
                preventTouchMove('floorControls');
            }


            // â˜…â˜…â˜… í•µì‹¬: ë§ˆìš°ìŠ¤ íœ  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ (ë¯¸ì„¸ ì¡°ì •) â˜…â˜…â˜…
            const ZOOM_STEP = 0.1;
mapContainer.addEventListener("wheel", function (e) {
                e.preventDefault();     // ê¸°ë³¸ í™•ëŒ€/ì¶•ì†Œ ê¸ˆì§€

                let currentZoom = map.getZoom();
                let newZoom = currentZoom;

                if (e.deltaY < 0) newZoom += ZOOM_STEP;   // í™•ëŒ€
         

                else newZoom -= ZOOM_STEP;                // ì¶•ì†Œ

                // ì†Œìˆ˜ì  2ìë¦¬ê¹Œì§€
                newZoom = Math.round(newZoom * 100) / 100;

                // ë„¤ì´ë²„ ì§€ë„ í—ˆìš© ë²”ìœ„
    
         
                newZoom = Math.min(Math.max(newZoom, 1), 21);

                // ì†Œìˆ˜ì  ì¤Œ ì ìš©
                map.setZoom(newZoom);
            }, { passive: false });
let groundOverlay = null; 
            let currentBuildingId = null; 
            let currentPositionMarker = null;
// =========================================================
            // ë¹Œë”©ë³„ ë°ì´í„° ì •ì˜ 
            // =========================================================
            const buildings = {
                'ky': { // ê±´ë¬¼ 1 (ì˜ˆì‹œ: ê²½í¬ê¶)
                    polygonCoords: [
            

                        new naver.maps.LatLng(37.571350, 126.977670),
                        new naver.maps.LatLng(37.571360, 126.978059),
                        new naver.maps.LatLng(37.571275, 126.978063),
                      
  new naver.maps.LatLng(37.571275, 126.978173),
        
                        new naver.maps.LatLng(37.570870, 126.978184),
                        new naver.maps.LatLng(37.570872, 126.978082),
                        new naver.maps.LatLng(37.570543, 126.978094),
          
              new naver.maps.LatLng(37.570539, 126.977702),
    
                    ],
                    floors: ['b1', '1f', '2f'],
                    images: {
                
        'b1': 'https://raw.githubusercontent.com/candream99/disabledmap/main/kb/ky_1.jpg',
               
                        '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/kb/ky11.png', 
                        '2f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/kb/ky_1.jpg',
                    },
     
               imageBounds: new naver.maps.LatLngBounds(
                      
                        new naver.maps.LatLng(37.570512, 126.977632), 
                        new naver.maps.LatLng(37.571415, 126.978244)  
      
              ),
                    currentFloor: '1f', 
                    polygon: null,
    
                    accessInfo: {
                  
      'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': true,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': true,
                        'ì§•ì• ì¸ ì£¼ì°¨ì¥': true,
     
                        'ì—˜ë¦¬ë² ì´í„°': true,
          
              'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': false 
                    },
                    // ê±´ë¬¼ ìƒì„¸ ì •ë³´
                    buildingInfo: {
      
             
           name: 'êµë³´ë¹Œë”©',
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/kb/kyobo_gwanghwamun.jpg', // ì˜ˆì‹œ ì´ë¯¸ì§€
                        address: 'ì„œìš¸ ì¢…ë¡œêµ¬ ìƒˆë¬¸ì•ˆë¡œ 45',
                        operating_hours: 
       
                     '09:00 - 18:00 (ì›”ìš”ì¼ íœ´ë¬´)'
                    }
                },
                'dt': { 
                    // 
ê±´ë¬¼ 2 (ì˜ˆì‹œ: ëˆì˜ë¬¸)
                  
                    polygonCoords: [
                        new naver.maps.LatLng(37.571470, 126.978762),
                        new naver.maps.LatLng(37.571476, 126.979161),
      
                  new naver.maps.LatLng(37.570627, 126.979181),
                   
                        new naver.maps.LatLng(37.570557, 126.979117),
                        new naver.maps.LatLng(37.570553, 126.978777),
         
           ],
                    floors: ['b4', '1f'], 
                    images: {
   
                        'b4': 'https://raw.githubusercontent.com/candream99/disabledmap/main/dt/dt_b4.png',
                 
       '1f': 'https://raw.githubusercontent.com/candream99/disabledmap/main/dt/dt1.png',
                    },
                    imageBounds: new naver.maps.LatLngBounds(
           
                        new naver.maps.LatLng(37.570459, 126.978649), 
            
            new naver.maps.LatLng(37.571626, 126.979210)  
                    ),
                    currentFloor: '1f',
               
                    polygon: null,
       
             accessInfo: {
                        'ì£¼ì¶œì…êµ¬ ê²½ì‚¬ë¡œ': false,
                        'ì¥ì• ì¸ í™”ì¥ì‹¤': true, 
                    
             
           'ì¥ì• ì¸ ì£¼ì°¨ì¥': false,
                        'ì—˜ë¦¬ë² ì´í„°': true,
                        'ì£¼ì¶œì…êµ¬ ë‹¨ì°¨': true 
                    },
               
     // ê±´ë¬¼ ìƒì„¸ ì •ë³´
                
                    buildingInfo: {
                        name: 'ê´‘í™”ë¬¸ Díƒ€ì›Œ',
                        image_url: 'https://raw.githubusercontent.com/candream99/disabledmap/main/dt/d_tower.jpg', // ì˜ˆì‹œ ì´ë¯¸ì§€
 
                       address: 'ì„œìš¸ ì¢…ë¡œêµ¬ ì†¡ì›”ê¸¸ 2',
            
                        operating_hours: '10:00 - 19:00 (ë§¤ì¼ ìš´ì˜)'
                    }
        }
    
        };

            // =========================================================
            // ëª¨ë°”ì¼ í„°ì¹˜ ì´ë²¤íŠ¸ ë²„ë¸”ë§/ìŠ¤í¬ë¡¤ ë°©ì§€ (ë°ìŠ¤í¬í†± ëª¨ë“œì—ì„œëŠ” ë¯¸ì‚¬ìš©)
            // =========================================================

            /**
             * íŠ¹ì • ìš”ì†Œ ë‚´ë¶€ì—ì„œ í„°ì¹˜ ì´ë™(ë“œë˜ê·¸)ì„ ë§‰ì•„
             * ë¸Œë¼ìš°ì €ì˜ ê¸°ë³¸ ì˜¤ë²„ìŠ¤í¬ë¡¤ ë° í™”ë©´ ì´ë™ì„ ë°©ì§€í•©ë‹ˆë‹¤.
*/
            function preventTouchMove(elementId) {
                const element = document.getElementById(elementId);
if (element) {
                    // í„°ì¹˜ ì´ë™(ë“œë˜ê·¸) ì´ë²¤íŠ¸ ë°œìƒ ì‹œ ë¸Œë¼ìš°ì € ê¸°ë³¸ ë™ì‘ ë°©ì§€
                    element.addEventListener('touchmove', function(e) {
                        e.preventDefault();
                    }, { passive: 
false });
                }
            }
            
            // =========================================================
            // í•µì‹¬ ë¡œì§ í•¨ìˆ˜
            // =========================================================

            /**
             * ì‹¤ë‚´ ëª¨ë“œ ì§„ì… ì‹œ UI ë³€ê²½
             */
            function enterIndoorMode(buildingId) {
            
 
                // ëª¨ë°”ì¼ìš© ê²€ìƒ‰ì°½ ìˆ¨ê¸°ê¸° (ë°ìŠ¤í¬í†±ì—ì„œëŠ” ì´ë¯¸ ìˆ¨ê¹€)
                searchBox.style.display = 'none';

                // coordDisplayì˜ ìœ„ì¹˜ë¥¼ ìƒë‹¨ìœ¼ë¡œ ì˜¬ë¦¼ (ë°ìŠ¤í¬í†± ëª¨ë“œì—ì„œëŠ” ì´ë¯¸ ì²˜ë¦¬)
                if (!isDesktop) {
                    coordDisplay.style.top = '10px';
                }
                
// --- ìˆ˜ì •ëœ í•µì‹¬ ë¡œì§: ê±´ë¬¼ ì¤‘ì‹¬ìœ¼ë¡œ ì´ë™í•˜ê³  ì¤Œ ë ˆë²¨ 18 ê³ ì • ---
                const config = buildings[buildingId];
if (config && config.polygonCoords && config.polygonCoords.length > 0) {
                    // 1. í´ë¦¬ê³¤ ì¢Œí‘œë¥¼ í¬í•¨í•˜ëŠ” LatLngBounds ìƒì„±
                    const bounds = new naver.maps.LatLngBounds();
config.polygonCoords.forEach(coord => bounds.extend(coord));
                    
                    // 2. LatLngBoundsì˜ ì¤‘ì‹¬ ì¢Œí‘œ ê³„ì‚° (ê±´ë¬¼ì˜ ì¤‘ì‹¬)
                    const centerPoint = bounds.getCenter();
// 3. ì§€ë„ë¥¼ ê±´ë¬¼ ì¤‘ì‹¬ìœ¼ë¡œ ì´ë™í•˜ê³  ì¤Œ ë ˆë²¨ì„ ìš”ì²­ëœ 18ë¡œ ê³ ì •
                    map.setCenter(centerPoint);
map.setZoom(18); // ìš”ì²­ëŒ€ë¡œ í•­ìƒ 18ë¡œ ê³ ì •
                }
                // --- ìˆ˜ì •ëœ í•µì‹¬ ë¡œì§ ë ---

                // ê¸°íƒ€ ì‹¤ë‚´ ëª¨ë“œ ì§„ì… ë¡œì§ ì‹¤í–‰
                currentBuildingId = buildingId;
labelLayer.setMap(null);
                floorControlsContainer.style.display = 'flex';
                coordDisplay.textContent = 'ì¼ë°˜ì§€ë„ë¡œ ëŒì•„ê°€ë ¤ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ í´ë¦­í•˜ì„¸ìš”';
}

            /**
             * ì‹¤ë‚´ ëª¨ë“œë¥¼ ì¢…ë£Œí•˜ê³  ì¼ë°˜ ì§€ë„ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.
*/
            function exitIndoorMode() {
                if (!currentBuildingId) return;
if (groundOverlay) {
                    groundOverlay.setMap(null);
}
                
                // íŒì—…ì°½ ë‹«ê¸° ë° 'i' ë²„íŠ¼ active í•´ì œ
                popup.style.display = 'none';
accessBtn.classList.remove('active');
                
                // ëª¨ë“  ê±´ë¬¼ í´ë¦¬ê³¤ ë³µì›
                for (const id in buildings) {
                    if (buildings[id].polygon) {
                        buildings[id].polygon.setMap(map);
buildings[id].polygon.setOptions({ fillColor: 'transparent' }); 
                    }
                }
            
                floorControlsContainer.style.display = 'none';
labelLayer.setMap(map);
                currentBuildingId = null; 
            
                // ì¼ë°˜ ëª¨ë“œë¡œ ë³µê·€ ì‹œ UI ë³€ê²½
                if (!isDesktop) {
                    searchBox.style.display = 'flex';
                // coordDisplay ìœ„ì¹˜ë¥¼ ê²€ìƒ‰ì°½ ì•„ë˜(top: 78px)ë¡œ ë³µì›
                    coordDisplay.style.top = '78px';
                }
// ë¬¸êµ¬ ë³€ê²½
                coordDisplay.textContent = 'ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”';
}

            // ì¸µ ì§€ë„(GroundOverlay) í‘œì‹œ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
            function showFloor(buildingId, floor) {
                const config = buildings[buildingId];
if (!config || !config.images[floor]) return;

                currentBuildingId = buildingId;
                config.currentFloor = floor; 
                
                if (groundOverlay) groundOverlay.setMap(null);
// ë‹¤ë¥¸ ê±´ë¬¼ í´ë¦¬ê³¤ ìˆ¨ê¸°ê¸°
                for (const id in buildings) {
                    if (id !== buildingId && buildings[id].polygon) {
                        buildings[id].polygon.setMap(null);
}
                }

                // í˜„ì¬ ìœ„ì¹˜ ë§ˆì»¤ê°€ ìˆë‹¤ë©´ ì œê±°
                if (currentPositionMarker) {
                    currentPositionMarker.setMap(null);
geolocationBtn.classList.remove('active'); 
                }

                groundOverlay = new naver.maps.GroundOverlay(
                    config.images[floor],
                    config.imageBounds,
                    {
                    

                        map: map,
                        clickable: true,
                        opacity: 1,
                    }
     
           );
// ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸: ì¸µ ë²„íŠ¼ë§Œ ë¹„í™œì„±í™” í›„ ì„ íƒëœ ë²„íŠ¼ í™œì„±í™”
                document.querySelectorAll('#floorControls .floor-btn:not(#accessInfoBtn)').forEach(btn => btn.classList.remove('active'));
const floorBtn = document.querySelector(`#floorControls .floor-btn[data-floor="${floor}"]`);
                if (floorBtn) floorBtn.classList.add('active');

                // ì‹¤ë‚´ ëª¨ë“œ ì¢…ë£Œ ë¦¬ìŠ¤ë„ˆ (GroundOverlay í´ë¦­ ì‹œ)
                naver.maps.Event.addListener(groundOverlay, 'click', function (e) {
                    e.stopOverlays = true;
                    exitIndoorMode(); 
                });
}

            // ì¸µ ë²„íŠ¼ ë™ì  ìƒì„± ë° ë Œë”ë§ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
            function renderFloorButtons(buildingId) {
                const config = buildings[buildingId];
// ê¸°ì¡´ ì¸µ ë²„íŠ¼ë§Œ ì œê±° (i ë²„íŠ¼ ì œì™¸)
                document.querySelectorAll('#floorControls .floor-btn:not(#accessInfoBtn)').forEach(btn => btn.remove());
const defaultFloor = config.floors.includes('1f') ? '1f' : config.floors[0];
                config.currentFloor = defaultFloor;
// ìƒˆë¡œìš´ ì¸µ ë²„íŠ¼ ìƒì„± ë° ì¶”ê°€
                config.floors.forEach(floor => {
                    const btn = document.createElement('button');
                    btn.className = 'floor-btn map-btn-circle'; 
                    btn.dataset.floor = floor;
       

                    btn.textContent = floor.toUpperCase();
                    
                    // 'i' ë²„íŠ¼ ë°”ë¡œ ìœ„ì— ì˜¤ë„ë¡ prepend
                    floorControlsContainer.prepend(btn);

            
       
                    if (floor === defaultFloor) {
                        btn.classList.add('active');
                    }

                    btn.addEventListener('click', () => {
  
                      showFloor(buildingId, floor);
   
                    });
                });
}

            /**
             * ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´ íŒì—… ë‚´ìš©ì„ ë™ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤. (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
*/
            function updateAccessPopup(buildingId) {
                const config = buildings[buildingId];
const accessInfo = config?.accessInfo;
                const buildingInfo = config?.buildingInfo;
                
                // íŒì—… ë‚´ìš© ì „ì²´ ì´ˆê¸°í™” (ì „ì—­ìœ¼ë¡œ ì„ ì–¸ëœ ë³€ìˆ˜ ì‚¬ìš©)
                buildingInfoSection.innerHTML = '';
accessFacilitySection.innerHTML = '';


                // =========================================================
                // 1. ê±´ë¬¼ ì •ë³´ ì„¹ì…˜ ë Œë”ë§
                // =========================================================
                if (buildingInfo) {
                    buildingInfoSection.innerHTML = `
                  

                        <img id="buildingImage" src="${buildingInfo.image_url}" alt="${buildingInfo.name} ì‚¬ì§„">
                        <div id="buildingTextInfo">
                            <div id="buildingName">${buildingInfo.name}</div>
                  
          <div class="info-item">
       
                                <i>ğŸ“</i>
                                <span>${buildingInfo.address}</span>
                  
          </div>
               
                            <div class="info-item">
                                <i>ğŸ•’</i>
              
                  <span>${buildingInfo.operating_hours}</span>
                      
                            </div>
                        </div>
        
            `;
} else {
                    buildingInfoSection.innerHTML = '<div>ê±´ë¬¼ ê¸°ë³¸ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
}

                
                // =========================================================
                // 2. ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´ ì„¹ì…˜ ë Œë”ë§
                // =========================================================
                if (!accessInfo) {
        

                    accessFacilitySection.innerHTML = '<div>ê±´ë¬¼ì— ëŒ€í•œ ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
return;
                }

                let html = '';
// ìš”ì²­í•˜ì‹  ì œëª©ì„ ë‘ ë²ˆì§¸ ì„¹ì…˜ì˜ ì²« ì¤„ë¡œ ì¶”ê°€
                html += '<div style="font-size:1.0rem; font-weight:700; margin-bottom:12px; color:#1e3a8a;">ë¬´ì¥ì•  ì‹œì„¤ì •ë³´</div>';
for (const facility in accessInfo) {
                    const isAvailable = accessInfo[facility];
let statusText, statusClass;

                    // 'ë‹¨ì°¨'ëŠ” 'ì—†ìŒ'ì„ ê¸ì •ì ì¸ ìƒí™©(ì¥ì• ë¬¼ ì—†ìŒ)ìœ¼ë¡œ ê°„ì£¼
                    if (facility.includes('ë‹¨ì°¨')) {
                        statusText = isAvailable ?
'ìˆìŒ' : 'ì—†ìŒ';
                        // ë‹¨ì°¨ê°€ 'ì—†ìŒ'ì´ë©´ ì´ˆë¡ìƒ‰, 'ìˆìŒ'ì´ë©´ ë¹¨ê°„ìƒ‰
                        statusClass = isAvailable ?
'status-negative' : 'status-positive'; 
                    } else {
                        statusText = isAvailable ?
'ìˆìŒ' : 'ì—†ìŒ';
                        // ë‚˜ë¨¸ì§€ ì‹œì„¤ì´ 'ìˆìŒ'ì´ë©´ ì´ˆë¡ìƒ‰, 'ì—†ìŒ'ì´ë©´ ë¹¨ê°„ìƒ‰
                        statusClass = isAvailable ?
'status-positive' : 'status-negative';
                    }

                    html += `
                        <div class="access-item">
                            <span>â€¢ ${facility}</span>
                     

                            <span class="access-status ${statusClass}">${statusText}</span>
                        </div>
                    `;
}
                accessFacilitySection.innerHTML = html;
}
            
            // ê±´ë¬¼ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ í•¨ìˆ˜ (ë°ìŠ¤í¬í†± ì „ìš©)
            function renderBuildingList() {
                buildingList.innerHTML = ''; // ê¸°ì¡´ ëª©ë¡ ì´ˆê¸°í™”

                for (const id in buildings) {
                    const config = buildings[id];
                    const info = config.buildingInfo;

                    if (!info) continue;

                    const listItem = document.createElement('div');
                    listItem.className = 'building-list-item';
                    listItem.dataset.buildingId = id;

                    listItem.innerHTML = `
                        <img class="list-item-image" src="${info.image_url}" alt="${info.name} ì‚¬ì§„">
                        <div class="list-item-text-info">
                            <div class="list-item-name">${info.name}</div>
                            <div class="list-info-item">
                                <i>ğŸ“</i>
                                <span>${info.address}</span>
                            </div>
                            <div class="list-info-item">
                                <i>ğŸ•’</i>
                                <span>${info.operating_hours}</span>
                            </div>
                        </div>
                    `;

                    // 1. ë§ˆìš°ìŠ¤ ì˜¤ë²„ ë¦¬ìŠ¤ë„ˆ (í´ë¦¬ê³¤ í•˜ì´ë¼ì´íŠ¸)
                    listItem.addEventListener('mouseover', function() {
                        const targetId = this.dataset.buildingId;
                        if (buildings[targetId] && buildings[targetId].polygon && (!groundOverlay || groundOverlay.getMap() === null)) {
                            buildings[targetId].polygon.setOptions({ fillColor: '#C490E4' });
                        }
                    });

                    // 2. ë§ˆìš°ìŠ¤ ì•„ì›ƒ ë¦¬ìŠ¤ë„ˆ (í´ë¦¬ê³¤ ë³µì›)
                    listItem.addEventListener('mouseout', function() {
                        const targetId = this.dataset.buildingId;
                        if (buildings[targetId] && buildings[targetId].polygon && (!groundOverlay || groundOverlay.getMap() === null)) {
                            buildings[targetId].polygon.setOptions({ fillColor: 'transparent' });
                        }
                    });
                    
                    // 3. í´ë¦­ ë¦¬ìŠ¤ë„ˆ (ì§€ë„ ì´ë™ ë° Zoom 18 ê³ ì •)
                    listItem.addEventListener('click', function() {
                        const targetId = this.dataset.buildingId;
                        const targetConfig = buildings[targetId];

                        if (targetConfig && targetConfig.polygonCoords) {
                            const bounds = new naver.maps.LatLngBounds();
                            targetConfig.polygonCoords.forEach(coord => bounds.extend(coord));
                            const centerPoint = bounds.getCenter();
                            
                            // ì§€ë„ ì´ë™ ë° Zoom 18 ê³ ì •
                            map.setCenter(centerPoint);
                            map.setZoom(18); 
                            
                            // ë°ìŠ¤í¬í†± ëª¨ë“œì—ì„œëŠ” 'ì‹¤ë‚´ ëª¨ë“œ ì§„ì…' ë¡œì§ì„ ì‹¤í–‰í•˜ì§€ ì•Šê³ , 
                            // ë‹¨ìˆœíˆ 'ì¤‘ì‹¬ ì´ë™ + Zoom 18'ë§Œ ìˆ˜í–‰í•©ë‹ˆë‹¤.
                            // ì‹¤ë‚´ ëª¨ë“œ ì§„ì…ì€ ì—¬ì „íˆ Polygon í´ë¦­ìœ¼ë¡œ ìœ ë„í•©ë‹ˆë‹¤.
                        }
                    });

                    buildingList.appendChild(listItem);
                }
            }


            // ê±´ë¬¼ë³„ Polygon ìƒì„± ë° ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            function setupBuilding(buildingId, config) {
                const polygon = new naver.maps.Polygon({
                    map: map,
                    paths: [config.polygonCoords],
     

                    fillColor: 'transparent',
                    fillOpacity: 0.5,
                    strokeColor: '#C490E4',
                    strokeOpacity: 1,
                
    strokeWeight: 
                        2,
                    clickable: true,
                });
config.polygon = polygon; 

                // ë§ˆìš°ìŠ¤ ì˜¤ë²„ ë¦¬ìŠ¤ë„ˆ 
                naver.maps.Event.addListener(polygon, 'mouseover', function() {
                    if (!groundOverlay || groundOverlay.getMap() === null) {
                        polygon.setOptions({ fillColor: '#C490E4' });
                     

                        coordDisplay.textContent = 'í´ë¦­í•´ì„œ ì‹¤ë‚´ì§€ë„ë¥¼ ë³´ì„¸ìš”';
                    }
                });
// ë§ˆìš°ìŠ¤ ì•„ì›ƒ ë¦¬ìŠ¤ë„ˆ 
                naver.maps.Event.addListener(polygon, 'mouseout', function() {
                    if (!groundOverlay || groundOverlay.getMap() === null) {
                        polygon.setOptions({ fillColor: 'transparent' });
                        

                        coordDisplay.textContent = isDesktop ? 'ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”' : 'ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”';
                    }
                });
// í´ë¦­ ë¦¬ìŠ¤ë„ˆ (ì‹¤ë‚´ ëª¨ë“œ ì§„ì…)
                naver.maps.Event.addListener(polygon, 'click', function (e) {
                    e.stopOverlays = true;
                    
                    enterIndoorMode(buildingId);

             

                    polygon.setOptions({ fillColor: '#C490E4' });
                    
                    if (currentPositionMarker) {
                        currentPositionMarker.setMap(null);
           
             
                        geolocationBtn.classList.remove('active'); 
                    }

                    renderFloorButtons(buildingId);
                    
  
                  const defaultFloor = config.floors.includes('1f') ? '1f' : config.floors[0];
            
                    showFloor(buildingId, defaultFloor);
                    
                    updateAccessPopup(buildingId); 
 
               });
}

            // =========================================================
            // í˜„ì¬ ìœ„ì¹˜ (Geolocation) ê¸°ëŠ¥ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
            // =========================================================
            geolocationBtn.addEventListener('click', function() {
                const isIndoorMode = currentBuildingId !== null;

                // 1. ì´ë¯¸ í™œì„±í™” ìƒíƒœë¼ë©´ (íŒŒë€ìƒ‰ ë²„íŠ¼) 

 
                if (geolocationBtn.classList.contains('active')) {
                    if (currentPositionMarker) {
                        currentPositionMarker.setMap(null);
                    }
               
 
                    geolocationBtn.classList.remove('active');
                    
                    if (isIndoorMode) {
                        coordDisplay.textContent = 'ì¼ë°˜ì§€ë„ë¡œ ëŒì•„ê°€ë ¤ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ í´ë¦­í•˜ì„¸ìš”';
        
            } else {
   
                        coordDisplay.textContent = 'ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”';
                    }
                    return;
            
    }

                
                // 2. Geolocation ì‹œì‘
                if (navigator.geolocation) {
                    coordDisplay.textContent = 'í˜„ì¬ ìœ„ì¹˜ë¥¼ ì°¾ëŠ” ì¤‘ì…ë‹ˆë‹¤...';
navigator.geolocation.getCurrentPosition(
                        function(position) {
                            const lat = position.coords.latitude;
                            const lng = position.coords.longitude;
             

                            const currentLatLng = new naver.maps.LatLng(lat, lng);

                            map.setCenter(currentLatLng);
                            map.setZoom(17); 

          
             
                            // ê¸°ì¡´ ë§ˆì»¤ ì œê±°
                            if (currentPositionMarker) {
                          
      currentPositionMarker.setMap(null);
                            }

  
                            // ìƒˆë¡œìš´ í˜„ì¬ ìœ„ì¹˜ ë§ˆì»¤ ìƒì„± (íŒŒë€ìƒ‰ ë„íŠ¸)
                            currentPositionMarker 
= new naver.maps.Marker({
                                map: map,
   
                                position: currentLatLng,
                             
   icon: {
                                    content: 
                                        '<div style="width:12px;
height:12px; background-color:#007bff; border-radius:50%; border:2px solid #ffffff; box-shadow:0 0 5px rgba(0,0,0,0.5);"></div>',
                                    size: new naver.maps.Size(12, 12),
                                    anchor: new naver.maps.Point(6, 6)
           
  
                              },
                                zIndex: 9999
                            });
         
         
                            
                            // ë¬¸êµ¬ ì—…ë°ì´íŠ¸
                            if (isIndoorMode) {
   
                           
                                coordDisplay.textContent = 'í˜„ì¬ ìœ„ì¹˜ë¡œ ì´ë™í–ˆìŠµë‹ˆë‹¤. ì‹¤ë‚´ì§€ë„ëŠ” ê·¸ëŒ€ë¡œ í‘œì‹œë©ë‹ˆë‹¤.';
                            } else {
    
                            coordDisplay.textContent = 'í˜„ì¬ ìœ„ì¹˜ë¡œ ì´ë™í–ˆìŠµë‹ˆë‹¤! ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”';
                   
                            }
               
             geolocationBtn.classList.add('active'); 

                        },
                        function(error) {
             
                        
    console.error("Geolocation Error:", error);
                            
                            let errorMsg = 'ìœ„ì¹˜ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ê±°ë‚˜ ì ‘ê·¼ì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.';
if (error.code === 1) {
                                errorMsg = 'ìœ„ì¹˜ ì •ë³´ ì ‘ê·¼ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.';
} else if (error.code === 2) {
                                errorMsg = 'ìœ„ì¹˜ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.';
}
                            
                            if (isIndoorMode) {
                                coordDisplay.textContent = `[ì—ëŸ¬] ${errorMsg}.
ì‹¤ë‚´ì§€ë„ë¡œ ëŒì•„ê°€ë ¤ë©´ í´ë¦­í•˜ì„¸ìš”`;
                            } else {
                                coordDisplay.textContent = `[ì—ëŸ¬] ${errorMsg}.
ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”`;
                            }
                            
                            if (currentPositionMarker) {
                                currentPositionMarker.setMap(null);
}
                            geolocationBtn.classList.remove('active');
},
                        { enableHighAccuracy: true, timeout: 5000, maximumAge: 0 } 
                    );
} else {
                    coordDisplay.textContent = 'Geolocation ë¯¸ì§€ì›: ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”';
}
            });
// =========================================================
            // ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
            // =========================================================

            // ëª¨ë“  ê±´ë¬¼ ì„¤ì •
            for (const id in buildings) {
                setupBuilding(id, buildings[id]);
}

            // ì§€ë„ í´ë¦­ ë¦¬ìŠ¤ë„ˆ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
            naver.maps.Event.addListener(map, 'click', function (e) {
                if (!groundOverlay || groundOverlay.getMap() === null) {
                    coordDisplay.textContent = 'ê±´ë¬¼ì„ í´ë¦­í•˜ë©´ ì‹¤ë‚´ì§€ë„ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”';
                }
 

            });
// ë¬´ì¥ì• ì‹œì„¤ ë²„íŠ¼ ('i' ë²„íŠ¼) í´ë¦­ ë¦¬ìŠ¤ë„ˆ (ê¸°ì¡´ ë¡œì§ ìœ ì§€)
            accessBtn.addEventListener('click', function() {
                // ì‹¤ë‚´ ëª¨ë“œê°€ ì•„ë‹ ê²½ìš° íŒì—…ì„ ì—´ì§€ ì•ŠìŠµë‹ˆë‹¤.
                if (!currentBuildingId) {
                    coordDisplay.textContent = 'ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´ëŠ” ê±´ë¬¼ì„ í´ë¦­í•˜ì—¬ ì‹¤ë‚´ ëª¨ë“œ ì§„ì… í›„ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”.';
     

                    return;
                }

                const isOpen = popup.style.display === 'block';
                
                if (!isOpen) {
         
     
                    // ië²„íŠ¼ì˜ ìœ„ì¹˜ ê³„ì‚°
                    const buttonRect = accessBtn.getBoundingClientRect();
                    
                    // ê¸°ì¡´ (buttonRect.right + 20)ì—ì„œ 15px ì™¼ìª½ìœ¼ë¡œ ì´ë™ (ì´ 
+ 5px)
                    let newPopupLeft = buttonRect.right + 5; 
                    
                    // ë°ìŠ¤í¬í†± ëª¨ë“œì¼ ê²½ìš° left ìœ„ì¹˜ë¥¼ ê³ ì •ëœ ê°’ìœ¼ë¡œ ì˜¤ë²„ë¼ì´ë“œ
                    if (isDesktop) {
                        newPopupLeft = 400; // CSSì—ì„œ ì„¤ì •í•œ ê°’ (íŒ¨ë„ 380 + 20)
                    }

                    // ğŸ’¥ ìˆ˜ì •: íŒì—… í•˜ë‹¨ì„ í™”ë©´ í•˜ë‹¨ì—ì„œ 20px ë„ì›Œ ê³ ì • ğŸ’¥
                    popup.style.bottom = '20px';
                    // 
íŒì—…ì˜ top ì†ì„±ì€ ì œê±°í•˜ê±°ë‚˜ ë¬´ì‹œë©ë‹ˆë‹¤.
                    
                    popup.style.left = newPopupLeft + 'px'; /* ìˆ˜ì •ëœ left ê°’ ì ìš© */
                    
                    // íŒì—… ì—´ê¸°
    
                popup.style.display = 'block';
                    this.classList.add('active');
} else {
                    // íŒì—… ë‹«ê¸°
                    popup.style.display = 'none';
this.classList.remove('active');
                }
            });
// ë¬´ì¥ì•  ì‹œì„¤ì •ë³´ íŒì—… ë‹«ê¸° ì´ë²¤íŠ¸ (X ë²„íŠ¼ í´ë¦­)
            if (popupClose) {
                // '=>' í™”ì‚´í‘œ í•¨ìˆ˜ë¥¼ 'function()' ì¼ë°˜ í•¨ìˆ˜ë¡œ ë³€ê²½í•˜ì—¬ í˜¸í™˜ì„±ì„ ë†’ì„
                popupClose.onclick = function() {
                    popup.style.display = 'none';
accessBtn.classList.remove('active');
                };
            }
        };
// API ë¡œë“œ ì‹¤íŒ¨ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€
        script.onerror = function () {
            console.error('ë„¤ì´ë²„ ì§€ë„ API ë¡œë“œ ì‹¤íŒ¨! URL ë˜ëŠ” Keyë¥¼ í™•ì¸í•˜ì„¸ìš”.');
};

        document.head.appendChild(script);
        
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ë„¤ì´ë²„ ë²¡í„°ë§µ í…ŒìŠ¤íŠ¸ - ë ˆì´ì•„ì›ƒ ìˆ˜ì •</title>
    <style>
        /* ------------------------------------------------ */
        /* ëª¨ë°”ì¼ ìŠ¤í¬ë¡¤ ì ê¸ˆ */
        /* ------------------------------------------------ */
        body { 
            margin: 0;
            padding: 0; 
            height: 100vh; /* ë·°í¬íŠ¸ ë†’ì´ë¡œ ê³ ì • */
            font-family: 'Malgun Gothic', sans-serif; 
            overflow: hidden; /* í˜ì´ì§€ ìì²´ì˜ ìŠ¤í¬ë¡¤ì„ ì™„ì „íˆ ë§‰ìŒ */
        }
        #map { width: 100%; height: 100%; }

        /* ------------------------------------------------ */
        /* ì™¼ìª½ íŒ¨ë„ ìŠ¤íƒ€ì¼ */
        /* ------------------------------------------------ */
        #leftPanel {
            position: absolute;
            top: 0;
            left: 0;
            width: 320px; /* íŒ¨ë„ ë„ˆë¹„ ê³ ì • */
            height: 100%;
            background-color: #ffffff;
            box-shadow: 4px 0 12px rgba(0,0,0,0.15);
            z-index: 1000; /* ì§€ë„ ìœ„ì— í‘œì‹œ */
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
        }

        /* ------------------------------------------------ */
        /* ê²€ìƒ‰ì°½ ìŠ¤íƒ€ì¼ */
        /* ------------------------------------------------ */
        #searchBox {
            position: absolute;
            top: 20px; 
            left: 50%;
            transform: translateX(-50%);
            width: 80vw; 
            max-width: 500px; 
            height: 48px;
            background: #ffffff;
            border-radius: 24px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
            z-index: 999; 
            display: flex;
            align-items: center;
            padding: 0 20px;
            pointer-events: none; /* ì§€ë„ê°€ ê²€ìƒ‰ì°½ ë’¤ì—ì„œ ì‘ë™í•˜ë„ë¡ ì„¤ì • */
        }
        /* ê²€ìƒ‰ì°½ ë‚´ë¶€ ìš”ì†ŒëŠ” í¬ì¸í„° ì´ë²¤íŠ¸ í—ˆìš© */
        #searchBox > * {
            pointer-events: auto;
        }
        #searchBox input {
            flex-grow: 1;
            border: none;
            outline: none;
            font-size: 16px;
            margin-right: 10px;
        }
        #searchBox button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 18px;
            color: #123456;
        }

        /* ------------------------------------------------ */
        /* ì¢Œí‘œ í‘œì‹œ (coordDisplay) ìŠ¤íƒ€ì¼ - ìƒë‹¨ ì¤‘ì•™ìœ¼ë¡œ ìˆ˜ì • */
        /* ------------------------------------------------ */
        #coordDisplay {
            position: absolute;
            /* ìƒë‹¨ ì¤‘ì•™ ë°°ì¹˜ */
            top: 10px; 
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 14px;
            z-index: 1000; /* ì§€ë„ ìš”ì†Œ ìœ„ë¡œ */
            pointer-events: none; /* ì§€ë„ í´ë¦­ ì´ë²¤íŠ¸ ë°©í•´ ë°©ì§€ */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* ------------------------------------------------ */
        /* ë²„íŠ¼ ê³µí†µ ìŠ¤íƒ€ì¼ */
        /* ------------------------------------------------ */
        .map-button {
            position: absolute;
            /* ê¸°ë³¸ì ìœ¼ë¡œ ì˜¤ë¥¸ìª½ì—ì„œ 20px ìœ„ì¹˜ */
            right: 20px; 
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background-color: #ffffff;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            border: none;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 20px;
            color: #333;
            z-index: 900;
            transition: background-color 0.2s, box-shadow 0.2s, left 0.3s; /* left ì†ì„± ì „í™˜ ì¶”ê°€ */
        }
        .map-button:hover {
            background-color: #f0f0f0;
        }
        .map-button.active {
            box-shadow: 0 0 0 3px #4285f4;
        }
        
        /* ------------------------------------------------ */
        /* ê°œë³„ ë²„íŠ¼ ìœ„ì¹˜ */
        /* ------------------------------------------------ */
        #zoomInBtn { top: 100px; }
        #zoomOutBtn { top: 150px; }
        #outdoorIndoorBtn { top: 200px; }
        #accessBtn { bottom: 20px; } /* ë§¨ ì•„ë˜ ê³ ì • */
        
        /* ------------------------------------------------ */
        /* ë¬´ì¥ì•  ì‹œì„¤ì •ë³´ íŒì—… ìŠ¤íƒ€ì¼ */
        /* ------------------------------------------------ */
        #accessPopup {
            position: absolute;
            bottom: 20px; /* í™”ë©´ í•˜ë‹¨ì— ê³ ì • */
            width: 300px;
            max-width: 90vw;
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 1050;
            padding: 15px;
            display: none; /* ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€ */
        }
        #accessPopup h3 {
            margin-top: 0;
            font-size: 18px;
            color: #123456;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
            margin-bottom: 10px;
        }
        #accessPopup p {
            margin: 5px 0;
            font-size: 14px;
            line-height: 1.5;
        }
        .popup-close-btn {
            position: absolute;
            top: 5px;
            right: 10px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #999;
        }
        .popup-close-btn:hover {
            color: #333;
        }

        /* ------------------------------------------------ */
        /* ëª¨ë°”ì¼ ë°˜ì‘í˜• ì²˜ë¦¬ */
        /* ------------------------------------------------ */
        @media (max-width: 768px) {
            #leftPanel {
                width: 90%; /* ëª¨ë°”ì¼ì—ì„œ ë„ˆë¹„ í™•ì¥ */
                max-width: none;
                z-index: 1100;
            }
            /* ëª¨ë°”ì¼ì—ì„œ ë²„íŠ¼ì€ ì˜¤ë¥¸ìª½ 20pxì— ìœ ì§€ */
            .map-button {
                right: 20px;
                left: auto !important; /* JSì—ì„œ ì„¤ì •ëœ left ê°’ì„ ì˜¤ë²„ë¼ì´ë“œ */
            }
            /* ëª¨ë°”ì¼ì—ì„œ íŒì—… ìœ„ì¹˜ */
            #accessPopup {
                left: 50% !important;
                transform: translateX(-50%);
                bottom: 10px;
            }
        }

    </style>
    <!-- ë„¤ì´ë²„ ì§€ë„ API ë¡œë“œ -->
    <!-- YOUR_CLIENT_IDë¥¼ ì‹¤ì œ í´ë¼ì´ì–¸íŠ¸ IDë¡œ êµì²´í•˜ì„¸ìš”. -->
    <script src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=YOUR_CLIENT_ID&submodules=panorama,geocoder"></script>
</head>
<body>
    <div id="map"></div>
    <div id="leftPanel">
        <h2>ì§€ë„ ì„¤ì • ë° ì •ë³´</h2>
        <p>ì´ê³³ì€ ì™¼ìª½ íŒ¨ë„ ì˜ì—­ì…ë‹ˆë‹¤. ë²„íŠ¼ê³¼ íŒì—…ì€ ì´ íŒ¨ë„ê³¼ ê²¹ì¹˜ì§€ ì•Šë„ë¡ ë°°ì¹˜ë©ë‹ˆë‹¤.</p>
        <button onclick="togglePanel(false)">íŒ¨ë„ ë‹«ê¸°</button>
    </div>
    <div id="searchBox">
        <button>ğŸ”</button>
        <input type="text" placeholder="ì¥ì†Œ ê²€ìƒ‰..." />
        <button>ğŸ¤</button>
    </div>

    <!-- ì¢Œí‘œ í‘œì‹œë¥¼ ìƒë‹¨ ì¤‘ì•™ìœ¼ë¡œ ì´ë™ -->
    <div id="coordDisplay"></div> 

    <!-- ë²„íŠ¼ë“¤ -->
    <button id="zoomInBtn" class="map-button">+</button>
    <button id="zoomOutBtn" class="map-button">-</button>
    <button id="outdoorIndoorBtn" class="map-button">ğŸ </button>
    <button id="accessBtn" class="map-button">â„¹</button>

    <!-- ë¬´ì¥ì•  ì‹œì„¤ì •ë³´ íŒì—… -->
    <div id="accessPopup">
        <button class="popup-close-btn">âœ–</button>
        <h3>ë¬´ì¥ì•  ì‹œì„¤ ì •ë³´</h3>
        <p>íœ ì²´ì–´ ê²½ì‚¬ë¡œ: **ìˆìŒ**</p>
        <p>ì¥ì• ì¸ í™”ì¥ì‹¤: **ë³„ë„ ìœ„ì¹˜**</p>
        <p>ìœ ë„ ë¸”ë¡: **ì •ìƒ ì‘ë™**</p>
        <p>ì—˜ë¦¬ë² ì´í„°: **ì‘ë™ ì¤‘**</p>
    </div>

    <script>
        const clientId = 'YOUR_CLIENT_ID'; // ì‹¤ì œ í´ë¼ì´ì–¸íŠ¸ IDë¡œ êµì²´ í•„ìš”

        // ------------------------------------------------
        // JavaScript í—¬í¼ í•¨ìˆ˜
        // ------------------------------------------------
        
        /**
         * ì§€ì •ëœ ìš”ì†Œì˜ CSS left ì†ì„±ì„ ê³„ì‚°í•˜ì—¬ ì„¤ì •í•©ë‹ˆë‹¤.
         * ì™¼ìª½ íŒ¨ë„ì˜ ë„ˆë¹„ì™€ ë§ˆì§„ì„ ê³ ë ¤í•©ë‹ˆë‹¤.
         * @param {HTMLElement} element - ìœ„ì¹˜ë¥¼ ì¡°ì •í•  ìš”ì†Œ
         */
        function setButtonPosition(element) {
            const panel = document.getElementById('leftPanel');
            const panelWidth = panel.offsetWidth; // í˜„ì¬ íŒ¨ë„ì˜ ë„ˆë¹„ (320px)
            const margin = 50; // íŒ¨ë„ ì˜¤ë¥¸ìª½ìœ¼ë¡œë¶€í„° 50px
            
            // íŒ¨ë„ì´ í™”ë©´ì— í‘œì‹œë˜ëŠ” ê²½ìš°ì—ë§Œ left ì†ì„± ì„¤ì •
            if (panelWidth > 0) {
                const newLeft = panelWidth + margin;
                element.style.left = `${newLeft}px`;
                element.style.right = 'auto'; // right ì†ì„± ë¬´ì‹œ
            } else {
                // íŒ¨ë„ì´ ë‹«í˜”ê±°ë‚˜ ìˆ¨ê²¨ì§„ ê²½ìš°, ì˜¤ë¥¸ìª½ ê¸°ë³¸ ìœ„ì¹˜ë¡œ ëŒì•„ê°
                element.style.left = 'auto';
                element.style.right = '20px'; 
            }
        }
        
        /**
         * ëª¨ë“  ë²„íŠ¼ì˜ ìœ„ì¹˜ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
         */
        function updateAllButtonPositions() {
            const buttons = [
                document.getElementById('zoomInBtn'),
                document.getElementById('zoomOutBtn'),
                document.getElementById('outdoorIndoorBtn'),
                document.getElementById('accessBtn')
            ];
            buttons.forEach(setButtonPosition);

            // íŒì—… ìœ„ì¹˜ë„ ì¬ê³„ì‚°
            const accessPopup = document.getElementById('accessPopup');
            if (accessPopup.style.display === 'block') {
                 // íŒì—…ì€ ë²„íŠ¼ì˜ ë°”ë¡œ ì˜¤ë¥¸ìª½ì— ë°°ì¹˜ë˜ë„ë¡ setPopupPositionì„ í˜¸ì¶œí•˜ê±°ë‚˜ ì§ì ‘ ê³„ì‚°
                 // ì—¬ê¸°ì„œëŠ” setPopupPosition ë¡œì§ì„ ë”°ë¼ ë²„íŠ¼ì˜ ìœ„ì¹˜ì— ë§ê²Œ ì—…ë°ì´íŠ¸
                const accessBtn = document.getElementById('accessBtn');
                const buttonRect = accessBtn.getBoundingClientRect();
                const newPopupLeft = buttonRect.right + 5; 
                accessPopup.style.left = newPopupLeft + 'px';
            }
        }

        /**
         * ì™¼ìª½ íŒ¨ë„ì˜ í‘œì‹œ ìƒíƒœë¥¼ í† ê¸€í•©ë‹ˆë‹¤.
         * @param {boolean} [shouldToggle=true] - í† ê¸€í• ì§€ ì—¬ë¶€. falseë©´ ë‹«ê¸°ë§Œ í•¨.
         */
        function togglePanel(shouldToggle = true) {
            const panel = document.getElementById('leftPanel');
            const isOpened = panel.offsetWidth > 0;
            
            if (shouldToggle) {
                // í† ê¸€
                panel.style.width = isOpened ? '0px' : '320px';
                panel.style.padding = isOpened ? '0px' : '20px';
            } else {
                // ë‹«ê¸°
                panel.style.width = '0px';
                panel.style.padding = '0px';
            }
            
            // íŒ¨ë„ ë„ˆë¹„ ë³€ê²½ í›„ ë²„íŠ¼ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
            // CSS transitionì´ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” ê²ƒì´ ì´ìƒì ì´ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” ì¦‰ì‹œ í˜¸ì¶œ
            setTimeout(updateAllButtonPositions, 300); // CSS transition ì‹œê°„(0.3s) í›„ ì—…ë°ì´íŠ¸
        }
        
        // ------------------------------------------------
        // ë„¤ì´ë²„ ì§€ë„ API ë¡œë“œ ë° ì´ˆê¸°í™”
        // ------------------------------------------------
        window.onload = function () {
            // ë„¤ì´ë²„ ì§€ë„ë¥¼ ì´ˆê¸°í™”í•˜ê³  'map' divì— ë Œë”ë§í•©ë‹ˆë‹¤.
            const map = new naver.maps.Map('map', {
                center: new naver.maps.LatLng(37.3595704, 127.105399), // ì´ˆê¸° ì¤‘ì‹¬ ì¢Œí‘œ (íŒêµì—­ ê·¼ì²˜)
                zoom: 15,
                mapTypeId: naver.maps.MapTypeId.NORMAL,
                logoControl: true,
                mapDataControl: true,
                zoomControl: true,
                scaleControl: true,
            });

            const coordDisplay = document.getElementById('coordDisplay');
            const accessBtn = document.getElementById('accessBtn');
            const accessPopup = document.getElementById('accessPopup');
            const popupClose = accessPopup.querySelector('.popup-close-btn');

            // 1. ì§€ë„ ì´ë™ ì‹œ ì¢Œí‘œ í‘œì‹œ ì—…ë°ì´íŠ¸ ì´ë²¤íŠ¸
            naver.maps.Event.addListener(map, 'idle', function () {
                const center = map.getCenter();
                const indoorLevel = map.getIndoorLevel() || 'ì‹¤ì™¸';
                const mapType = map.getMapTypeId();
                
                // coordDisplay ì—…ë°ì´íŠ¸
                coordDisplay.innerHTML = `ìœ„ë„: ${center.lat().toFixed(5)}, ê²½ë„: ${center.lng().toFixed(5)} | ì¸µ: ${indoorLevel} | íƒ€ì…: ${mapType.replace('normal', 'ì¼ë°˜').replace('satellite', 'ìœ„ì„±')}`;
            });

            // 2. ì´ˆê¸° ë²„íŠ¼ ìœ„ì¹˜ ì„¤ì • ë° í™”ë©´ í¬ê¸° ë³€ê²½ ì‹œ ì—…ë°ì´íŠ¸
            updateAllButtonPositions();
            window.addEventListener('resize', updateAllButtonPositions);
            
            // 3. ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ

            // ì˜ˆì‹œ: ì‹¤ë‚´ì™¸ ëª¨ë“œ ì „í™˜ ë²„íŠ¼
            const indoorOutdoorBtn = document.getElementById('outdoorIndoorBtn');
            indoorOutdoorBtn.addEventListener('click', function() {
                if (map.getMapTypeId() === naver.maps.MapTypeId.INDOOR) {
                    map.setMapTypeId(naver.maps.MapTypeId.NORMAL);
                    this.innerHTML = 'ğŸ '; // ì‹¤ë‚´ ë‹«ê¸°
                    console.log('ì‹¤ì™¸ ëª¨ë“œ ì „í™˜');
                } else {
                    // ì‹¤ë‚´ ëª¨ë“œë¡œ ì „í™˜ (ì˜ˆì‹œ ì¢Œí‘œì— ì‹¤ë‚´ ë§µì´ ìˆë‹¤ê³  ê°€ì •)
                    map.setMapTypeId(naver.maps.MapTypeId.INDOOR); 
                    this.innerHTML = 'ğŸ¢'; // ì‹¤ë‚´ ì—´ê¸°
                    console.log('ì‹¤ë‚´ ëª¨ë“œ ì „í™˜');
                }
            });

            // ì˜ˆì‹œ: í™•ëŒ€/ì¶•ì†Œ ë²„íŠ¼
            document.getElementById('zoomInBtn').addEventListener('click', function() {
                map.setZoom(map.getZoom() + 1, true);
            });
            document.getElementById('zoomOutBtn').addEventListener('click', function() {
                map.setZoom(map.getZoom() - 1, true);
            });

            // 4. ë¬´ì¥ì•  ì‹œì„¤ì •ë³´ íŒì—… í† ê¸€ ì´ë²¤íŠ¸
            accessBtn.addEventListener('click', function() {
                const isPopupVisible = accessPopup.style.display === 'block';

                if (!isPopupVisible) {
                    // ië²„íŠ¼ì˜ í˜„ì¬ ìœ„ì¹˜ ê³„ì‚°
                    const buttonRect = accessBtn.getBoundingClientRect();
                    
                    // íŒ¨ë„ ë„ˆë¹„ê°€ 0ì¼ ê²½ìš°(ë‹«íŒ ê²½ìš°), íŒì—…ì€ ì˜¤ë¥¸ìª½ ì •ë ¬(right: 20px)
                    // íŒ¨ë„ ë„ˆë¹„ê°€ 320pxì¼ ê²½ìš°, íŒì—…ì€ íŒ¨ë„ ì˜¤ë¥¸ìª½ + 50px + 5px(ë²„íŠ¼ê³¼ì˜ ê°„ê²©)ì— ìœ„ì¹˜
                    
                    let newPopupLeft;

                    if (document.getElementById('leftPanel').offsetWidth > 0) {
                        // íŒ¨ë„ì´ ì—´ë ¤ ìˆì„ ë•Œ: ë²„íŠ¼ ì˜¤ë¥¸ìª½ + 5px
                        newPopupLeft = buttonRect.right + 5; 
                    } else {
                        // íŒ¨ë„ì´ ë‹«í˜€ ìˆì„ ë•Œ: í™”ë©´ ì˜¤ë¥¸ìª½ì—ì„œ íŒì—… ë„ˆë¹„ + 20px ë§Œí¼ ë„ì›Œì„œ ì˜¤ë¥¸ìª½ ì •ë ¬
                        // ì´ ë¡œì§ì€ CSS right: 20pxì´ ì„¤ì •ë˜ì—ˆì„ ë•Œ, íŒì—…ì´ ë²„íŠ¼ ì˜¤ë¥¸ìª½ì— ë°°ì¹˜ë˜ëŠ” ê²ƒì„ ê°€ì •í•¨.
                        // ì •í™•í•œ ê³„ì‚°ì„ ìœ„í•´ ë²„íŠ¼ì˜ left ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
                        newPopupLeft = buttonRect.right + 5; 
                        
                        // ëª¨ë°”ì¼ ë·°í¬íŠ¸ì—ì„œëŠ” ì¤‘ì•™ ì •ë ¬ (CSS ë¯¸ë””ì–´ ì¿¼ë¦¬ì—ì„œ ì²˜ë¦¬)
                        if (window.innerWidth <= 768) {
                             // ëª¨ë°”ì¼ì—ì„œëŠ” ì¤‘ì•™ ì •ë ¬ì„ ìœ„í•´ left: 50%ì™€ transform: translateX(-50%)ë¥¼ ì‚¬ìš©
                             accessPopup.style.left = '50%';
                             accessPopup.style.transform = 'translateX(-50%)';
                        } else {
                             // ë°ìŠ¤í¬í†±ì—ì„œëŠ” ë²„íŠ¼ ì˜¤ë¥¸ìª½ ì •ë ¬
                             accessPopup.style.left = newPopupLeft + 'px'; 
                             accessPopup.style.transform = 'none';
                        }
                    }

                    // íŒì—… í•˜ë‹¨ì„ í™”ë©´ í•˜ë‹¨ì—ì„œ 20px ë„ì›Œ ê³ ì • (CSSì—ì„œ ì´ë¯¸ ì²˜ë¦¬ë¨)
                    // accessPopup.style.bottom = '20px'; 
                    accessPopup.style.display = 'block';
                    this.classList.add('active');
                } else {
                    // íŒì—… ë‹«ê¸°
                    accessPopup.style.display = 'none';
                    this.classList.remove('active');
                }
            });

            // ë¬´ì¥ì•  ì‹œì„¤ì •ë³´ íŒì—… ë‹«ê¸° ì´ë²¤íŠ¸ (X ë²„íŠ¼ í´ë¦­)
            if (popupClose) {
                popupClose.onclick = function() {
                    accessPopup.style.display = 'none';
                    accessBtn.classList.remove('active');
                };
            }
            
            // 5. ì™¼ìª½ íŒ¨ë„ í† ê¸€ ë²„íŠ¼ ì¶”ê°€ (ì˜ˆì‹œ)
            const panelToggleBtn = document.createElement('button');
            panelToggleBtn.innerHTML = 'â–¶';
            panelToggleBtn.style.position = 'absolute';
            panelToggleBtn.style.top = '10px';
            panelToggleBtn.style.left = '320px';
            panelToggleBtn.style.zIndex = '1001';
            panelToggleBtn.style.border = 'none';
            panelToggleBtn.style.background = '#fff';
            panelToggleBtn.style.padding = '10px';
            panelToggleBtn.style.cursor = 'pointer';
            panelToggleBtn.style.transition = 'left 0.3s';

            panelToggleBtn.onclick = function() {
                togglePanel();
                const isOpened = document.getElementById('leftPanel').offsetWidth > 0;
                panelToggleBtn.innerHTML = isOpened ? 'â—€' : 'â–¶';
                panelToggleBtn.style.left = isOpened ? '320px' : '0px';
            };
            document.body.appendChild(panelToggleBtn);
            
            // ì´ˆê¸° ë²„íŠ¼ ìœ„ì¹˜ ì„¤ì •
            updateAllButtonPositions();
        };

    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë„¤ì´ë²„ ë²¡í„°ë§µ í…ŒìŠ¤íŠ¸ (feat. í˜¸ë­ì´) - ë¼ë²¨ ì˜¨ì˜¤í”„ & ì¢Œí‘œ í‘œì‹œ</title>
    <style>
        body { margin: 0;
            padding: 0; height: 100vh; font-family: 'Malgun Gothic', sans-serif; }
        #map { width: 100%;
            height: 100%; }
        #status {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255, 99, 71, 0.9); /* ì‹œì‘ì€ ì—¬ì „íˆ í™í•œ í† ë§ˆí†  */
            color: white;
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 14px;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        #labelToggleBtn {
            position: absolute;
            top: 10px;
            left: 170px; /* status ë°•ìŠ¤ ì˜†ì— ë†“ê¸° ìœ„í•´ left ê°’ ì¡°ì ˆ */
            background: #4A90E2;
            /* ë²„íŠ¼ ìƒ‰ìƒ */
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            font-size: 14px;
            cursor: pointer;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: background 0.3s ease;
        }
        #labelToggleBtn:hover {
            background: #357ABD;
        }
        #coordDisplay {
            position: absolute;
            top: 50px; /* ë¼ë²¨ ë²„íŠ¼ ì•„ë˜ì— í‘œì‹œ */
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: #FFC107; /* ë°ì€ ë…¸ë‘ìƒ‰ìœ¼ë¡œ ëˆˆì— ë„ê²Œ!
            */
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 14px;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            min-width: 250px; /* ìµœì†Œ ë„ˆë¹„ë¡œ ë‚´ìš© ì—†ì–´ë„ í˜•íƒœ ìœ ì§€ */
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="status">API í‚¤ í™•ì¸ ì¤‘...</div>
    <button id="labelToggleBtn">ë¼ë²¨ ìˆ¨ê¸°ê¸°</button>
    <div id="coordDisplay">ì§€ë„ë¥¼ í´ë¦­í•˜ë©´ ì¢Œí‘œê°€ ë‚˜ì™€ìš”!</div>
    <div id="map"></div>
    

    <script>
        // í˜¸ë­ì´ Key ID ë°•ì œ!
        const NCP_KEY_ID = 'q1d23mmkof';

        const script = document.createElement('script');
        script.src = `https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=${NCP_KEY_ID}&vmode=3`;
        script.onload = function() {
            document.getElementById('status').textContent = 'API ë¡œë“œ ì„±ê³µ!
            ë²¡í„° ì§€ë„ ì´ˆê¸°í™” ì¤‘...';
            document.getElementById('status').style.background = 'rgba(60, 179, 113, 0.9)';
            // ì§€ë„ ì´ˆê¸° ì˜µì…˜ ì„¤ì •
            const mapOptions = {
                center: new naver.maps.LatLng(37.570946, 126.97788), // ì„œìš¸ì‹œì²­ ìœ„ê²½ë„
                zoom: 18,
                zoomControl: true,
                zoomControlOptions: {
        
                    position: naver.maps.Position.TOP_RIGHT
                },
                mapTypes: new naver.maps.MapTypeRegistry({
                    'normal': naver.maps.NaverStyleMapTypeOptions.getVectorMap()
                })
            };
            const map = new naver.maps.Map('map', mapOptions);
            map.setMapTypeId('normal');
            
            // ë¼ë²¨ ë ˆì´ì–´ ì„¤ì •
            const labelLayer = new naver.maps.LabelLayer();
            labelLayer.setMap(map);

            document.getElementById('status').style.display = 'none';

            // ë¼ë²¨ í† ê¸€ ë²„íŠ¼ ê¸°ëŠ¥
            const labelToggleBtn = document.getElementById('labelToggleBtn');
            let isLabelVisible = true;

            labelToggleBtn.addEventListener('click', function() {
                if (isLabelVisible) {
                    labelLayer.setMap(null);
                    labelToggleBtn.textContent = 'ë¼ë²¨ ë³´ì´ê¸°';
                    isLabelVisible = false;
           
                    console.log("ë¼ë²¨ ìˆ¨ê¹€!");
                } else {
                    labelLayer.setMap(map);
                    labelToggleBtn.textContent = 'ë¼ë²¨ ìˆ¨ê¸°ê¸°';
                    isLabelVisible = true;
       
                    console.log("ë¼ë²¨ ë³´ì„!");
                }
            });
            // -------------------------------------------------------------------
            // â­â­ ë‹¤ê°í˜•(Polygon) ê¸°ëŠ¥ â­â­
            // -------------------------------------------------------------------

            // 1. ë‹¤ê°í˜•ì˜ ê¼­ì§“ì  ì¢Œí‘œ ì •ì˜
            const polygonCoords = [
                new naver.maps.LatLng(37.571348, 126.977671),
                new naver.maps.LatLng(37.571354, 
                    126.978059),
                new naver.maps.LatLng(37.570541, 126.978091),
                new naver.maps.LatLng(37.570538, 126.977698)
            ];
            // 2. Polygon ê°ì²´ ìƒì„±: clickable: trueê°€ í•µì‹¬ì…ë‹ˆë‹¤.
            const polygon = new naver.maps.Polygon({
                map: map,
                paths: [polygonCoords],
                fillColor: 'transparent', // ì´ˆê¸°ì—ëŠ” ì±„ìš°ê¸° ì—†ìŒ
                fillOpacity: 0.5,
                
                strokeColor: '#C490E4', // ì—°í•œ ë³´ë¼ìƒ‰ ì™¸ê³½ì„ 
                strokeOpacity: 1,
                strokeWeight: 3,
                clickable: true // ì´ ê°ì²´ê°€ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë°›ì„ ìˆ˜ ìˆë„ë¡ ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •
            });
            // 3. ë§ˆìš°ìŠ¤ ì˜¤ë²„(Hover) íš¨ê³¼ ì¶”ê°€
            
            // ë§ˆìš°ìŠ¤ ì˜¤ë²„ ì‹œ: ë°˜íˆ¬ëª… ë³´ë¼ìƒ‰ìœ¼ë¡œ ì±„ìš°ê¸°
            naver.maps.Event.addListener(polygon, 'mouseover', function() {
                polygon.setOptions({
                    fillColor: '#C490E4' // ë°˜íˆ¬ëª…ì˜ ë³´ë¼ìƒ‰
          
                });
                document.getElementById('coordDisplay').textContent = 'ì—¬ê¸°ëŠ” ë‹¤ê°í˜• ë‚´ë¶€ì…ë‹ˆë‹¤! (ë§ˆìš°ìŠ¤ ì˜¤ë²„)';
            });
            // ë§ˆìš°ìŠ¤ ì•„ì›ƒ ì‹œ: ì±„ìš°ê¸° ìƒ‰ìƒ ì œê±° (transparent)
            naver.maps.Event.addListener(polygon, 'mouseout', function() {
                // **GroundOverlayê°€ í™œì„±í™” ìƒíƒœê°€ ì•„ë‹ˆë¼ë©´** ì›ë˜ ë©”ì‹œì§€ë¡œ ë³µê·€
                if (!groundOverlay || groundOverlay.getMap() === null) { 
                    polygon.setOptions({
                        fillColor: 'transparent'
                    });
                    document.getElementById('coordDisplay').textContent = 'ì§€ë„ë¥¼ í´ë¦­í•˜ë©´ ì¢Œí‘œê°€ ë‚˜ì™€ìš”!';
                }
            });

            // 4. í´ë¦­ ì´ë²¤íŠ¸ ì œí•œ ì¶”ê°€ (ë‹¤ê°í˜• ë‚´ë¶€ í´ë¦­ ì‹œ ì§€ë„ ì´ë²¤íŠ¸ ì „íŒŒ ì¤‘ë‹¨) - **ì•„ë˜ GroundOverlay ê¸°ëŠ¥ìœ¼ë¡œ ëŒ€ì²´ ë˜ëŠ” í†µí•©ë¨**
            /* naver.maps.Event.addListener(polygon, 'click', function(e) {
                e.stop(); 
                document.getElementById('coordDisplay').textContent = 'ğŸš« ë‹¤ê°í˜• 
                ë‚´ë¶€ í´ë¦­! ì¢Œí‘œ í‘œì‹œ ê¸°ëŠ¥ì´ ì œí•œë©ë‹ˆë‹¤.';
                console.log("ë‹¤ê°í˜• ë‚´ë¶€ í´ë¦­ ê°ì§€: ì§€ë„ ì¢Œí‘œ í‘œì‹œ ê¸°ëŠ¥ ì¤‘ë‹¨ë¨.");
            });
            */

            // -------------------------------------------------------------------
            // â­â­ GroundOverlay(í‰ë©´ë„) ë° ì‹¤ë‚´ ëª¨ë“œ ì¶”ê°€ ê¸°ëŠ¥ â­â­
            // -------------------------------------------------------------------
            
            // ì´ë¯¸ì§€ ì •ë³´
            const imageUrl = 'https://github.com/candream99/disabledmap/kb/ky_1.jpg';
            const swLatLng = new naver.maps.LatLng(37.570535, 126.977631); // ë‚¨ì„œìª½ (ì¢Œì¸¡ í•˜ë‹¨)
            const neLatLng = new naver.maps.LatLng(37.571365, 126.978099); // ë¶ë™ìª½ (ìš°ì¸¡ ìƒë‹¨)
            const imageBounds = new naver.maps.LatLngBounds(swLatLng, neLatLng);

            let groundOverlay = null; // GroundOverlay ê°ì²´ë¥¼ ë‹´ì„ ë³€ìˆ˜

            // GroundOverlay ê°ì²´ ìƒì„± í•¨ìˆ˜
            function createGroundOverlay() {
                groundOverlay = new naver.maps.GroundOverlay(imageUrl, imageBounds, {
                    map: null, // ì´ˆê¸°ì—ëŠ” ì§€ë„ì— í‘œì‹œí•˜ì§€ ì•ŠìŒ
                    clickable: true, // ì´ë¯¸ì§€ ìì²´ í´ë¦­ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
                    opacity: 1
                });

                // ğŸŒŸ GroundOverlay í´ë¦­ ì´ë²¤íŠ¸: ì´ë¯¸ì§€ í´ë¦­ ì‹œ ì œê±°
                naver.maps.Event.addListener(groundOverlay, 'click', function(e) {
                    e.stop(); // ì´ë¯¸ì§€ í´ë¦­ ì‹œ ì´ë²¤íŠ¸ ì „íŒŒ ë°©ì§€
                    
                    // ì´ë¯¸ì§€ ì œê±° (ì‹¤ë‚´ ëª¨ë“œ ì¢…ë£Œ)
                    groundOverlay.setMap(null); 
                    polygon.setOptions({ // ë‹¤ê°í˜• ìƒ‰ìƒ íˆ¬ëª…í•˜ê²Œ ë³µêµ¬
                        fillColor: 'transparent' 
                    });
                    document.getElementById('coordDisplay').textContent = 'ì§€ë„ë¥¼ í´ë¦­í•˜ë©´ ì¢Œí‘œê°€ ë‚˜ì™€ìš”!';
                    console.log("í‰ë©´ë„ í´ë¦­: ì‹¤ë‚´ ëª¨ë“œ ì¢…ë£Œ.");
                });
            }

            // ë‹¤ê°í˜•(Polygon) í´ë¦­ ì´ë²¤íŠ¸ ìˆ˜ì •: ì‹¤ë‚´ ëª¨ë“œ ì§„ì…
            naver.maps.Event.addListener(polygon, 'click', function(e) {
                e.stop(); // ë‹¤ê°í˜• ë‚´ë¶€ í´ë¦­ ì‹œ ì§€ë„ í´ë¦­ ì´ë²¤íŠ¸ ì „íŒŒ ì¤‘ë‹¨

                if (!groundOverlay) {
                    createGroundOverlay();
                }

                // GroundOverlay í‘œì‹œ (ì‹¤ë‚´ ëª¨ë“œ ì‹œì‘)
                groundOverlay.setMap(map);
                polygon.setOptions({ // ë‹¤ê°í˜•ì„ ì±„ì›Œì§„ ìƒíƒœë¡œ ìœ ì§€
                    fillColor: '#C490E4' 
                });
                document.getElementById('coordDisplay').textContent = 'ğŸ¢ ì‹¤ë‚´ ëª¨ë“œ í™œì„±í™”. ì´ë¯¸ì§€ë¥¼ í´ë¦­í•˜ë©´ ì¼ë°˜ ì§€ë„ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤.';
                console.log("ë‹¤ê°í˜• ë‚´ë¶€ í´ë¦­: ì‹¤ë‚´ ëª¨ë“œ ì§„ì….");
            });

            // â­ ì§€ë„ í´ë¦­ ì´ë²¤íŠ¸ (ë‹¤ê°í˜• ë°–ì„ í´ë¦­í–ˆì„ ë•Œë§Œ ì‘ë™)
            naver.maps.Event.addListener(map, 'click', function(e) {
                // GroundOverlayê°€ í‘œì‹œë˜ì§€ ì•Šì•˜ì„ ë•Œë§Œ ì¢Œí‘œ í‘œì‹œ ê¸°ëŠ¥ ì‹¤í–‰
                if (!groundOverlay || groundOverlay.getMap() === null) {
                    const lat = e.latlng.lat().toFixed(6);
         
                    const lng = e.latlng.lng().toFixed(6);
                    document.getElementById('coordDisplay').textContent = `ìœ„ë„: ${lat}, ê²½ë„: ${lng}`;
                    console.log(`í´ë¦­ëœ ì¢Œí‘œ: ìœ„ë„ ${lat}, ê²½ë„ ${lng}`);
                } else {
                    // ì‹¤ë‚´ ëª¨ë“œì¼ ê²½ìš° ì§€ë„ í´ë¦­ ë¬´ì‹œ
                    e.stop();
                    console.log("ì‹¤ë‚´ ëª¨ë“œ ì¤‘: ì§€ë„ í´ë¦­ ë¬´ì‹œë¨.");
                }
            });
            // -------------------------------------------------------------------
            // â­â­ GroundOverlay(í‰ë©´ë„) ë° ì‹¤ë‚´ ëª¨ë“œ ì¶”ê°€ ê¸°ëŠ¥ ì™„ë£Œ â­â­
            // -------------------------------------------------------------------

            console.log("ë„¤ì´ë²„ ë²¡í„°ë§µ ë¡œë“œ ë° ì´ˆê¸°í™” ì„±ê³µ! ë¼ë²¨ í† ê¸€ ë° ì¢Œí‘œ í‘œì‹œ ê¸°ëŠ¥, ì‹¤ë‚´ ëª¨ë“œ ì¶”ê°€ë¨.");
        };
        script.onerror = function() {
            document.getElementById('status').textContent = 'API ë¡œë“œ ì‹¤íŒ¨!
            ë„¤ì´ë²„ Key ID ë˜ëŠ” ì›¹ ì„œë¹„ìŠ¤ URLì„ í™•ì¸í•´ì£¼ì„¸ìš”. ã… ã… ';
            document.getElementById('status').style.background = 'red';
            console.error("ë„¤ì´ë²„ ì§€ë„ API ë¡œë“œ ì‹¤íŒ¨!");
        };
        document.head.appendChild(script);
    </script>
</body>
</html>
